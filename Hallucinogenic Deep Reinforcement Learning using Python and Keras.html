<!DOCTYPE html>
<!-- saved from url=(0109)https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459 -->
<html xmlns:cc="http://creativecommons.org/ns#"><style type="text/css" id="night-mode-pro-style"></style><link type="text/css" rel="stylesheet" id="night-mode-pro-link"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/ptrack-v1.1.0-engagedtime-slots.js"></script><script src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/medium.com"></script><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Hallucinogenic Deep Reinforcement Learning using Python and Keras</title><link rel="canonical" href="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459"><meta name="title" content="Hallucinogenic Deep Reinforcement Learning using Python and Keras"><meta name="referrer" content="always"><meta name="description" content="A step-by-step guide to reproducing the World Models paper https://arxiv.org/pdf/1803.10122.pdf"><meta name="theme-color" content="#000000"><meta property="og:title" content="Hallucinogenic Deep Reinforcement Learning using Python and Keras"><meta property="og:url" content="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*ynKeQFaQJn4NxmViJW4KAg.gif"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="Teaching a machine to master car racing and fireball avoidance through “World Models”"><meta name="twitter:description" content="Teaching a machine to master car racing and fireball avoidance through “World Models”"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*ynKeQFaQJn4NxmViJW4KAg.gif"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@dtfoster"><meta property="author" content="David Foster"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="David Foster"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-04-17T15:56:02.741Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="13 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/64fb388ba459"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/64fb388ba459"><meta property="al:android:url" content="medium://p/64fb388ba459"><meta property="al:web:url" content="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/64fb388ba459"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":386,"height":186,"url":"https://cdn-images-1.medium.com/max/386/1*ynKeQFaQJn4NxmViJW4KAg.gif"},"url":"https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459","dateCreated":"2018-04-17T15:56:02.741Z","datePublished":"2018-04-17T15:56:02.741Z","dateModified":"2018-07-01T08:52:59.839Z","headline":"Hallucinogenic Deep Reinforcement Learning using Python and Keras","name":"Hallucinogenic Deep Reinforcement Learning using Python and Keras","thumbnailUrl":"https://cdn-images-1.medium.com/max/386/1*ynKeQFaQJn4NxmViJW4KAg.gif","keywords":["Tag:Machine Learning","Tag:Artificial Intelligence","Tag:Deep Learning","Tag:Data Science","Tag:Google","Publication:applied-data-science","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"David Foster","url":"https://medium.com/@dtfoster"},"creator":["David Foster"],"publisher":{"@type":"Organization","name":"Applied Data Science","url":"https://medium.com/applied-data-science","logo":{"@type":"ImageObject","width":201,"height":60,"url":"https://cdn-images-1.medium.com/max/201/1*2A6OcWvQBoboXH2AW0LQMw.png"}},"mainEntityOfPage":"https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459"}</script><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/m2.css"><link rel="stylesheet" href="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/main-branding-base.JRYmM9hSxI_DawfiPjxqbQ.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*KAi60U6aOWD27X9CFI369A.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*KAi60U6aOWD27X9CFI369A.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*KAi60U6aOWD27X9CFI369A.png"><link rel="apple-touch-icon" sizes="60x60" href="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_KAi60U6aOWD27X9CFI369A.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome is-withMagicUnderlinesv-glyph v-glyph--m2 is-js is-withMagicUnderlines" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1532089944371" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1304" height="629"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"><div class="paragraphControls js-paragraphControl js-paragraphControl-d670 u-noUserSelect is-visible" style="top: 3902px;"><span class="paragraphControls-itemText"><button class="button button--chromeless" data-action="select-anchor" data-action-value="d670">Top highlight</button></span></div><div class="paragraphControls js-paragraphControl js-paragraphControl-4f67 u-noUserSelect is-visible" style="top: 7990px;"><span class="paragraphControls-itemText"><button class="button button--chromeless" data-action="select-anchor" data-action-value="4f67"></button></span></div></div></div><div class="metabar u-clearfix js-metabar u-textColorTransparentWhiteDarker u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth u-tintBgColor u-tintSpectrum"><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingLeft20 u-paddingRight20"><div class="metabar-block u-flex1  u-flexCenter"><div class="js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-textColorDarker"><svg class="svgIcon-use" width="45" height="45" viewBox="0 0 45 45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-flexCenter u-height65 u-xs-height56"><span class="u-inlineBlock u-height28 u-xs-height24 u-verticalAlignTop u-marginRight20 u-marginLeft15 u-borderRightTransparentWhiteLighter"></span></div><div class="u-flexCenter u-height65 u-xs-height56 u-marginRight18"><a class="js-collectionLogoOrName u-uiTextBold u-fontSize18 u-lineHeightTightest u-xs-fontSize22" href="https://medium.com/applied-data-science?source=logo-lo_6eca48311aab---70cd67c5d0e"><img height="36" width="121" class="u-paddingTop5" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_2A6OcWvQBoboXH2AW0LQMw.png" alt="Applied Data Science"></a></div><div class="u-flexCenter u-height65 u-xs-height56 u-xs-hide"><div class="buttonSet"><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton is-smallPill" data-action="sign-up-prompt" data-sign-in-action="toggle-follow-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/applied-data-science" data-action-source="----70cd67c5d0e----------------------follow_header" data-collection-id="70cd67c5d0e"><span class="button-label  js-buttonLabel">Follow</span></button><a class="button button--light button--chromeless is-touchIconBlackPulse u-baseColor--buttonLight button--withIcon button--withSvgIcon" href="https://twitter.com/applied_data" title="Visit “Applied Data Science” on Twitter" aria-label="Visit “Applied Data Science” on Twitter" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a></div></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-flexCenter u-height65 u-xs-height56"><div class="buttonSet buttonSet--wide u-lineHeightInherit"><a class="button button--primary button--light button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fapplied-data-science%2Fhow-to-build-your-own-world-model-using-python-and-keras-64fb388ba459&amp;source=--------------------------nav_reg&amp;operation=login" data-action="sign-in-prompt" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-action-source="--------------------------nav_reg">Sign in</a><a class="button button--primary button--light button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2Fapplied-data-science%2Fhow-to-build-your-own-world-model-using-python-and-keras-64fb388ba459&amp;source=--------------------------nav_reg&amp;operation=register" data-action="sign-up-prompt" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-action-source="--------------------------nav_reg">Get started</a></div></div></div></div><div class="metabar-inner u-marginAuto u-maxWidth1000 js-metabarBottom"><nav role="navigation" class="metabar-block metabar-block--below u-overflowHidden u-height44"><ul class="u-textAlignLeft u-noWrap u-overflowX u-paddingBottom100 u-sm-paddingLeft20 u-sm-paddingRight20 js-collectionNavItems"><li class="metabar-navItem js-collectionNavItem u-uiTextMedium u-fontSize14 u-inlineBlock u-textUppercase u-letterSpacing003 u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-paddingTop5 u-xs-paddingTop10"><a class="link link--darken u-accentColor--textDarken u-baseColor--link js-homeNav" href="https://medium.com/applied-data-science">Home</a></li><li class="metabar-navItem js-collectionNavItem  u-uiTextMedium u-fontSize14 u-inlineBlock u-textUppercase u-letterSpacing003 u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-paddingTop5 u-xs-paddingTop10"><a class="link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink" href="https://medium.com/applied-data-science/tagged/data-science">Blog</a></li><span class="u-borderLeft1 u-paddingLeft12 u-baseColor--borderLight"></span><li class="metabar-navItem js-collectionNavItem  u-paddingLeft0 is-external u-uiTextMedium u-fontSize14 u-inlineBlock u-textUppercase u-letterSpacing003 u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-paddingTop5 u-xs-paddingTop10"><a class="link link--darkenOnHover u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink" href="http://applied-data.science/" rel="nofollow noopener" target="_blank">MAIN SITE</a></li><li class="metabar-navItem js-collectionNavItem u-uiTextMedium u-fontSize14 u-inlineBlock u-textUppercase u-letterSpacing003 u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-paddingTop5 u-xs-paddingTop10"><a class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-top1" href="https://medium.com/applied-data-science/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span></span></a></li></ul></nav></div></div><div class="metabar metabar--spacer js-metabarSpacer u-tintBgColor  u-height105 u-xs-height95"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors u-marginBottom40" lang="en"><header class="container u-maxWidth740"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaLockup postMetaLockup--authorWithBio u-flexCenter js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@dtfoster?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="2d3c4b088dc6" data-action-type="hover" data-user-id="2d3c4b088dc6" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_QqMD1rth7ahcS7Gc415R9w.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of David Foster"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-lineHeightTightest"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@dtfoster?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="2d3c4b088dc6" data-action-type="hover" data-user-id="2d3c4b088dc6" dir="auto">David Foster</a><span class="followState js-followState" data-user-id="2d3c4b088dc6"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/2d3c4b088dc6" data-action-source="post_header_lockup-2d3c4b088dc6-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption ui-xs-clamp2 postMetaInline">Co-founder of Applied Data Science</div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2018-04-17T15:56:02.741Z">Apr 17</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="13 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="64fb388ba459" data-source="post_page" data-collection-id="70cd67c5d0e" data-tracking-context="postPage" data-scroll="native"><section name="022c" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="ec2c" id="ec2c" class="graf graf--figure graf--leading"><div class="aspectRatioPlaceholder is-locked" style="max-width: 386px; max-height: 186px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48.199999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ynKeQFaQJn4NxmViJW4KAg.gif" data-width="386" data-height="186" data-is-featured="true" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_ynKeQFaQJn4NxmViJW4KAg.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="35"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*ynKeQFaQJn4NxmViJW4KAg.gif" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_ynKeQFaQJn4NxmViJW4KAg(1).gif"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*ynKeQFaQJn4NxmViJW4KAg.gif"&gt;</noscript></div></div></figure><h1 name="9477" id="9477" class="graf graf--h3 graf-after--figure graf--title">Hallucinogenic Deep Reinforcement Learning Using Python and&nbsp;Keras</h1><h2 name="6c4a" id="6c4a" class="graf graf--h4 graf-after--h3 graf--subtitle">Teaching a machine to master car racing and fireball avoidance through “World&nbsp;Models”</h2><p name="c552" id="c552" class="graf graf--p graf-after--h4">If Artificial Intelligence is your thing, you need to check this out:</p><div name="8b86" id="8b86" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://worldmodels.github.io/" data-href="https://worldmodels.github.io/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://worldmodels.github.io/" rel="nofollow"><strong class="markup--strong markup--mixtapeEmbed-strong">World Models</strong><br><em class="markup--em markup--mixtapeEmbed-em">Interactive demo: Tap screen to override the agent's decisions. We explore building generative neural network models of…</em>worldmodels.github.io</a><a href="https://worldmodels.github.io/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="5770ecbe3de72f58296083461c71e44a" data-thumbnail-img-id="0*NQf6CAAmOUPLWPL3." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*NQf6CAAmOUPLWPL3.);"></a></div><p name="5ad7" id="5ad7" class="graf graf--p graf-after--mixtapeEmbed"><a href="https://arxiv.org/abs/1803.10122" data-href="https://arxiv.org/abs/1803.10122" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank"><strong class="markup--strong markup--p-strong">https://arxiv.org/abs/1803.10122</strong></a></p><p name="fa8a" id="fa8a" class="graf graf--p graf-after--p">In short, it’s a masterpiece, for three reasons:</p><ol class="postList"><li name="bf75" id="bf75" class="graf graf--li graf-after--p">It combines several deep/reinforcement learning techniques to produce an amazing result — the first known agent to solve the popular 'Car Racing' reinforcement learning environment.</li><li name="5793" id="5793" class="graf graf--li graf-after--li">It’s written in a very accessible style, so a great learning resource for anyone interested in cutting-edge AI</li><li name="1b6d" id="1b6d" class="graf graf--li graf-after--li">You can code the solution yourself</li></ol><p name="cbdc" id="cbdc" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">This post is a step by step guide through the paper</strong>.</p><p name="c366" id="c366" class="graf graf--p graf-after--p">We’ll cover the technical details and also walk through how you can get a version running on your own machine.</p><p name="a8da" id="a8da" class="graf graf--p graf-after--p graf--trailing"><em class="markup--em markup--p-em">Similarly to my post on </em><a href="https://medium.com/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188" data-href="https://medium.com/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188" class="markup--anchor markup--p-anchor" target="_blank"><em class="markup--em markup--p-em">AlphaZero</em></a><em class="markup--em markup--p-em">, I’m not associated with the authors of the paper but just wanted to share my interpretation of their terrific work.</em></p></div></div></section><section name="02fc" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="995b" id="995b" class="graf graf--figure graf--layoutOutsetLeft graf--leading" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 378px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72%;"></div><a href="https://applied-data.science/the-network/" data-href="https://applied-data.science/the-network/" class="graf-imageAnchor" data-action="image-link" data-action-observe-only="true" rel="nofollow"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*8eLAymZlVovZrB0Vel-nQg.png" data-width="1450" data-height="1044" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_8eLAymZlVovZrB0Vel-nQg.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="52"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/600/1*8eLAymZlVovZrB0Vel-nQg.png" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_8eLAymZlVovZrB0Vel-nQg(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/600/1*8eLAymZlVovZrB0Vel-nQg.png"&gt;</noscript></div></a></div></figure><blockquote name="0cea" id="0cea" class="graf graf--pullquote graf-after--figure graf--leading">First, a quick note about a new platform, The Network — a place where data scientists can find paid contract projects with businesses!</blockquote><blockquote name="263f" id="263f" class="graf graf--pullquote graf-after--pullquote graf--trailing">Click ‘Register’ to start building your&nbsp;profile.</blockquote></div></div></section><section name="5cae" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--outsetColumn"><figure name="ab0f" id="ab0f" class="graf graf--figure graf--layoutOutsetCenter graf--leading" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*zv2Hy8IwUKqH2ruz5kFHMg.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_zv2Hy8IwUKqH2ruz5kFHMg.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="af9c" id="af9c" class="graf graf--h3 graf-after--figure">Step 1: The&nbsp;Problem</h3><p name="5893" id="5893" class="graf graf--p graf-after--h3">We’re going to build a reinforcement learning algorithm (an ‘agent’) that gets good at driving a car around a 2D racetrack. This environment (Car Racing) is available through the <a href="https://gym.openai.com/" data-href="https://gym.openai.com/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--p-strong">OpenAI Gym</strong></a></p><p name="0cc7" id="0cc7" class="graf graf--p graf-after--p">At each time-step, the algorithm is fed an observation (a 64 x 64 pixel colour image of the car and immediate surroundings) and needs to return the next set of actions to take — specifically, the steering direction (-1 to 1), acceleration (0 to 1) and brake (0 to 1).</p><p name="7356" id="7356" class="graf graf--p graf-after--p">This action is then passed to the environment, which returns the next observation and the cycle starts again.</p><p name="9da6" id="9da6" class="graf graf--p graf-after--p">An agent scores 1000/N for each of the N track tiles visited and -0.1 for each time-step taken. For example, if the agent completes the track in 732 frames, the reward is 1000–0.1*732 = 926.8 points.</p><figure name="43b7" id="43b7" class="graf graf--figure graf--layoutOutsetLeft graf-after--p" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 350px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*Yil5VbPHSoHcEOrnGOobUQ.gif" data-width="600" data-height="400" data-action="zoom" data-action-value="1*Yil5VbPHSoHcEOrnGOobUQ.gif" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_Yil5VbPHSoHcEOrnGOobUQ.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/600/1*Yil5VbPHSoHcEOrnGOobUQ.gif" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_Yil5VbPHSoHcEOrnGOobUQ(1).gif"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/600/1*Yil5VbPHSoHcEOrnGOobUQ.gif"&gt;</noscript></div></div></figure><p name="08d2" id="08d2" class="graf graf--p graf-after--figure">Here’s an example of an agent that chooses the action [0,1 0] for the first 200 time-steps then something random…not a great driving strategy.</p><p name="4d61" id="4d61" class="graf graf--p graf-after--p">The aim is to train the agent to understand that it can use information from its surroundings to inform the next best action.</p><figure name="4cec" id="4cec" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*U8VHQ030UBt33BXOGjmtbQ.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_U8VHQ030UBt33BXOGjmtbQ.png"></div></figure><h3 name="f802" id="f802" class="graf graf--h3 graf-after--figure">Step 2: The&nbsp;Solution</h3><p name="07f6" id="07f6" class="graf graf--p graf-after--h3">There is an excellent online <a href="https://worldmodels.github.io/" data-href="https://worldmodels.github.io/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">interactive explanation of the methodology</a>, written by the authors, so I won’t go into the same level of detail here, but instead will focus on a high-level summary of how the pieces fit together, with an analogy to real driving to explain why the solution intuitively makes sense.</p><p name="c17e" id="c17e" class="graf graf--p graf-after--p">The solution consists of three distinct parts, which are trained separately:</p><h4 name="bcf0" id="bcf0" class="graf graf--h4 graf-after--p">A Variational Autoencoder (VAE)</h4><p name="a4e0" id="a4e0" class="graf graf--p graf-after--h4">When you make decisions whilst driving, you don’t actively analyse every single ‘pixel’ in your view — instead your brain condenses the visual information into a smaller number of ‘latent’ entities, such as the straightness of the road, upcoming bends and your position relative to the road, to inform your next action.</p><p name="d670" id="d670" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">This is exactly what the VAE is trained to do</strong> — condense the 64x64x3 (RGB) input image into <span class="markup--quote markup--p-quote is-other" name="anon_94ec5def51ee" data-creator-ids="anon">a 32-dimensional latent vector (z) that follows a Gaussian distribution.</span></p><p name="2515" id="2515" class="graf graf--p graf-after--p">This is useful because the agent can now work with a much smaller representation of its surroundings and therefore can be more efficient in its learning.</p><h4 name="b1e7" id="b1e7" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">A Recurrent Neural Network with Mixture Density Network output layer (MDN-RNN)</strong></h4><figure name="4d80" id="4d80" class="graf graf--figure graf--layoutOutsetLeft graf-after--h4" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 480px; max-height: 433px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 90.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*s-yfIRkx0T_gbS1SYaldkw.gif" data-width="480" data-height="433" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_s-yfIRkx0T_gbS1SYaldkw.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="67"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/600/1*s-yfIRkx0T_gbS1SYaldkw.gif" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_s-yfIRkx0T_gbS1SYaldkw(1).gif"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/600/1*s-yfIRkx0T_gbS1SYaldkw.gif"&gt;</noscript></div></div></figure><p name="9f63" id="9f63" class="graf graf--p graf-after--figure">If you didn’t have an MDN-RNN component to your decision making, your driving might look something like this.</p><p name="d904" id="d904" class="graf graf--p graf-after--p">As you drive, each subsequent observation isn’t a complete surprise to you. You know that if the current observation suggests a left turn in the road and you turn the wheel left, you expect the next observation to show that you are still in line with the road.</p><p name="b270" id="b270" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">This forward thinking is the job of the RNN</strong> — specifically this a Long Short-Term Memory Network (LSTM) with 256 hidden units. The vector of hidden states is represented by h.</p><p name="a3d9" id="a3d9" class="graf graf--p graf-after--p">Similarly to the VAE, the RNN tries to capture a latent understanding of the current state of the car in its environment, but this time with the aim of predicting what the next ‘z’ might look like, based on the previous ‘z’ and the previous action.</p><p name="6e04" id="6e04" class="graf graf--p graf-after--p">The MDN output layer simply allows for the fact that the next ‘z’ could actually be drawn from any one of several Gaussian distributions.</p><figure name="2e4e" id="2e4e" class="graf graf--figure graf--layoutOutsetLeft graf-after--p" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 400px; max-height: 237px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*pJIaYNT1RWCRUq8IDKz-2Q.png" data-width="400" data-height="237" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_pJIaYNT1RWCRUq8IDKz-2Q.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="42"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/600/1*pJIaYNT1RWCRUq8IDKz-2Q.png" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_pJIaYNT1RWCRUq8IDKz-2Q(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/600/1*pJIaYNT1RWCRUq8IDKz-2Q.png"&gt;</noscript></div></div><figcaption class="imageCaption">MDN for handwriting generation</figcaption></figure><p name="7884" id="7884" class="graf graf--p graf-after--figure">The same technique was applied in <a href="http://blog.otoro.net/2015/12/28/recurrent-net-dreams-up-fake-chinese-characters-in-vector-format-with-tensorflow/" data-href="http://blog.otoro.net/2015/12/28/recurrent-net-dreams-up-fake-chinese-characters-in-vector-format-with-tensorflow/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this</a> article, by the same author, for handwriting generation, to describe the fact that the next pen point could land in any one of the red distinct areas.</p><p name="739e" id="739e" class="graf graf--p graf-after--p">Similarly, in the World Models paper, the next observed latent state could be drawn from any one of five Gaussian distributions.</p><h4 name="7a75" id="7a75" class="graf graf--h4 graf-after--p">The Controller</h4><p name="bf4d" id="bf4d" class="graf graf--p graf-after--h4">Up until this point, we haven’t mentioned anything about choosing an action. That responsibility lies with the Controller.</p><p name="ce87" id="ce87" class="graf graf--p graf-after--p graf--trailing">The Controller is simply a <strong class="markup--strong markup--p-strong">densely connected neural network</strong>, where the input is a concatenation of z (the current latent state from the VAE — length 32) and h (the hidden state of the RNN — length 256). The 3 output neurons correspond to the three actions and are scaled to fall in the appropriate ranges.</p></div></div></section><section name="c010" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h4 name="2c4d" id="2c4d" class="graf graf--h4 graf--leading">A dialogue</h4><p name="9423" id="9423" class="graf graf--p graf-after--h4">To understand the different roles of the three components and how they work together, we can imagine a dialogue between them:</p><figure name="07f0" id="07f0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 249px; max-height: 179px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 71.89999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*_iOdKbAgXsHZ6vDIx6sOnw.png" data-width="249" data-height="179" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1__iOdKbAgXsHZ6vDIx6sOnw.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="52"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*_iOdKbAgXsHZ6vDIx6sOnw.png" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1__iOdKbAgXsHZ6vDIx6sOnw(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*_iOdKbAgXsHZ6vDIx6sOnw.png"&gt;</noscript></div></div><figcaption class="imageCaption">Diagram of the World Model architecture (source: <a href="https://arxiv.org/pdf/1803.10122.pdf" data-href="https://arxiv.org/pdf/1803.10122.pdf" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://arxiv.org/pdf/1803.10122.pdf</a>)</figcaption></figure><blockquote name="b9ff" id="b9ff" class="graf graf--blockquote graf-after--figure">VAE: (looks at latest 64*64*3 observation) This looks like a straight road, with a slight left bend approaching, with the car facing in the direction of the road (z).</blockquote><blockquote name="cb3b" id="cb3b" class="graf graf--blockquote graf-after--blockquote">RNN: Based on that description (z) and the fact that the Controller chose to accelerate hard at the last time-step (action), I will update my hidden state (h) so that the next observation is predicted to still be a straight road, but with slightly more left turn in view.</blockquote><blockquote name="49d3" id="49d3" class="graf graf--blockquote graf-after--blockquote">Controller: Based on the description from the VAE (z) and the current hidden state from the RNN (h) my neural network outputs next action to be [0.34, 0.8, 0].</blockquote><p name="12db" id="12db" class="graf graf--p graf-after--blockquote graf--trailing">This action is then passed to the environment, which returns an updated observation and the cycle begins again.</p></div></div></section><section name="0328" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="0709" id="0709" class="graf graf--p graf--leading">We’ll now look at how to set up an environment that allows you to train your own version of the agent for car racing.</p><p name="e14a" id="e14a" class="graf graf--p graf-after--p">Time for some code!</p><h3 name="43e9" id="43e9" class="graf graf--h3 graf-after--p">Step 3: Set up your environment</h3><p name="65c6" id="65c6" class="graf graf--p graf-after--h3">If you’ve got a high-spec laptop, you can run the solution locally, but I’d recommend using <a href="https://cloud.google.com/compute/" data-href="https://cloud.google.com/compute/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Google Cloud Compute</a> for access to powerful machines that you can use in short bursts.</p><p name="79c0" id="79c0" class="graf graf--p graf-after--p">The following has been tested on Linux (Ubuntu 16.04) — just change the relevant commands for package installation if you’re on Mac or Windows.</p><ol class="postList"><li name="7a96" id="7a96" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Clone the </strong><a href="https://github.com/AppliedDataSciencePartners/WorldModels" data-href="https://github.com/AppliedDataSciencePartners/WorldModels" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank"><strong class="markup--strong markup--li-strong">repository</strong></a></li></ol><p name="cdd5" id="cdd5" class="graf graf--p graf-after--li">In the command line, navigate to the place you want to store the repository and enter the following:</p><pre name="6236" id="6236" class="graf graf--pre graf-after--p">git clone https://github.com/AppliedDataSciencePartners/WorldModels.git</pre><p name="d166" id="d166" class="graf graf--p graf-after--pre">The repository is adapted from the highly useful <a href="https://github.com/hardmaru/estool" data-href="https://github.com/hardmaru/estool" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">estool</a> library developed by David Ha, the first author of the World Models paper.</p><p name="dc19" id="dc19" class="graf graf--p graf-after--p">For the neural network training, this implementation uses <a href="https://keras.io/" data-href="https://keras.io/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">Keras</a> with a <a href="https://www.tensorflow.org/" data-href="https://www.tensorflow.org/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Tensorflow</a> backend, though in the original paper the authors used raw Tensorflow.</p><p name="7425" id="7425" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Set up a virtual environment</strong></p><p name="3080" id="3080" class="graf graf--p graf-after--p">Create yourself a Python 3 virtual environment (I use virutalenv and virtualenvwrapper)</p><pre name="4f67" id="4f67" class="graf graf--pre graf-after--p"><span class="markup--quote markup--pre-quote is-other" name="4e664702f6ab" data-creator-ids="2d3c4b088dc6">sudo apt-get install python-pip</span><br>sudo pip install virtualenv<br>sudo pip install virtualenvwrapper<br>export WORKON_HOME=~/.virtualenvs<br>source /usr/local/bin/virtualenvwrapper.sh<br>mkvirtualenv --python=/usr/bin/python3 worldmodels</pre><p name="ca65" id="ca65" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2. Install packages</strong></p><pre name="5c01" id="5c01" class="graf graf--pre graf-after--p">sudo apt-get install cmake swig python3-dev zlib1g-dev python-opengl mpich xvfb xserver-xephyr vnc4server</pre><p name="ca37" id="ca37" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">3. Install requirements.txt</strong></p><pre name="5cc7" id="5cc7" class="graf graf--pre graf-after--p">cd WorldModels<br>pip install -r requirements.txt</pre><p name="b054" id="b054" class="graf graf--p graf-after--pre">There are more here than required by the Car Racing example, but you’ll have everything installed in case you want to test out some of the other environments in Open AI gym, that require the additional packages.</p><figure name="3c69" id="3c69" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*yRdffHYsR1-cPqqxoKghKg.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_yRdffHYsR1-cPqqxoKghKg.png"></div></figure><h3 name="6bbd" id="6bbd" class="graf graf--h3 graf-after--figure">Step 4: Generate random&nbsp;rollouts</h3><p name="413d" id="413d" class="graf graf--p graf-after--h3">For the Car Racing environment, both the VAE and RNN can be on <strong class="markup--strong markup--p-strong">random</strong> rollout data — that is, observation data generated by randomly taking actions at each time-step. Actually, we use pseudo-random actions, which forces the car to accelerate initially, in order to get it off the start line.</p><p name="46a6" id="46a6" class="graf graf--p graf-after--p">Since the VAE and RNN are independent of the decision-making Controller, all we need to ensure is that we encounter a diverse range of observations and choose a diverse range of actions to save as training data.</p><p name="f146" id="f146" class="graf graf--p graf-after--p">To generate the random rollouts, run the following from the command line</p><pre name="0cc0" id="0cc0" class="graf graf--pre graf-after--p">python 01_generate_data.py car_racing --total_episodes 2000 --start_batch 0 --time_steps 300</pre><p name="9307" id="9307" class="graf graf--p graf-after--pre">or if you’re on a server without a display,</p><pre name="b63a" id="b63a" class="graf graf--pre graf-after--p">xvfb-run -a -s "-screen 0 1400x900x24" python 01_generate_data.py car_racing --total_episodes 2000 --start_batch 0 --time_steps 300</pre><p name="cefc" id="cefc" class="graf graf--p graf-after--pre">This will produce 2000 rollouts (saved in ten batches of 200), starting with batch number 0. Each rollout will be a maximum of 300 time-steps long</p><p name="e5ee" id="e5ee" class="graf graf--p graf-after--p">Two sets of files are saved in&nbsp;<code class="markup--code markup--p-code">./data</code>, (* is the batch number)</p><p name="f56e" id="f56e" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">obs_data_*.npy</code> (stores the 64*64*3 images as numpy arrays)</p><p name="1b8f" id="1b8f" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">action_data_*.npy </code>(stores the 3 dimensional actions)</p><figure name="26d2" id="26d2" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*cbMhKPxI2aLmQ1semQoRKw.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_cbMhKPxI2aLmQ1semQoRKw.png"></div></figure><h3 name="3a9e" id="3a9e" class="graf graf--h3 graf-after--figure">Step 5: Train the&nbsp;VAE</h3><p name="67a3" id="67a3" class="graf graf--p graf-after--h3">Training the VAE only requires the <code class="markup--code markup--p-code">obs_data_*.npy</code> files. Make sure you’ve completed Step 4, so that these files exist in the&nbsp;<code class="markup--code markup--p-code">./data</code> folder.</p><p name="585b" id="585b" class="graf graf--p graf-after--p">From the command line, run:</p><pre name="c650" id="c650" class="graf graf--pre graf-after--p">python 02_train_vae.py --start_batch 0 --max_batch 9 --new_model</pre><p name="7120" id="7120" class="graf graf--p graf-after--pre">This will train a new VAE on each batch of data from 0 to 9.</p><p name="1427" id="1427" class="graf graf--p graf-after--p">The model weights will be saved to&nbsp;<code class="markup--code markup--p-code">./vae/weights.h5</code>. The <code class="markup--code markup--p-code">--new_model</code> flag tells the script to train the model from scratch.</p><p name="dc8a" id="dc8a" class="graf graf--p graf-after--p">If there is an existing <code class="markup--code markup--p-code">weights.h5</code> in this folder and the <code class="markup--code markup--p-code">--new_model</code> flag is not specified, the script will load the weights from this file and continue training the existing model. This way, you can iteratively train your VAE in batches, rather than all in one go.</p><p name="1558" id="1558" class="graf graf--p graf-after--p">The VAE architecture specification in the&nbsp;<code class="markup--code markup--p-code">./vae/arch.py</code> file.</p><figure name="5f17" id="5f17" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*JKOI6lJJqSgJeN1W_25-gw.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_JKOI6lJJqSgJeN1W_25-gw.png"></div></figure><h3 name="e055" id="e055" class="graf graf--h3 graf-after--figure">Step 6: Generate RNN&nbsp;data</h3><p name="2044" id="2044" class="graf graf--p graf-after--h3">Now that we have a trained VAE, we can use it to generate the training set for the RNN.</p><p name="f9b1" id="f9b1" class="graf graf--p graf-after--p">The RNN requires encoded image data (z) from the VAE and actions (a) as input and one time-step ahead encoded image data from the VAE as output.</p><p name="c06f" id="c06f" class="graf graf--p graf-after--p">You can generate this data by running:</p><pre name="d273" id="d273" class="graf graf--pre graf-after--p">python 03_generate_rnn_data.py --start_batch 0 --max_batch 9</pre><p name="f4e3" id="f4e3" class="graf graf--p graf-after--pre">This will take the <code class="markup--code markup--p-code">obs_data_*.npy</code> and <code class="markup--code markup--p-code">action_data_*.npy</code> files from batches 0 to 9 and convert them to the correct format required by the RNN for training.</p><p name="6ce5" id="6ce5" class="graf graf--p graf-after--p">Two sets of files will be saved in&nbsp;<code class="markup--code markup--p-code">./data</code>, (* is the batch number)</p><p name="97f8" id="97f8" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">rnn_input_*.npy</code> (stores the [z a] concatenated vectors)</p><p name="cc18" id="cc18" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">rnn_output_*.npy </code>(stores the z vector one time-step ahead)</p><figure name="b587" id="b587" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*MZVrVvObKi4ZxAtiOP0QFw.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_MZVrVvObKi4ZxAtiOP0QFw.png"></div></figure><h3 name="263d" id="263d" class="graf graf--h3 graf-after--figure">Step 7: Train the&nbsp;RNN</h3><p name="4045" id="4045" class="graf graf--p graf-after--h3">Training the RNN only requires the <code class="markup--code markup--p-code">rnn_input_*.npy</code> and <code class="markup--code markup--p-code">rnn_output_*.npy </code>files. Make sure you’ve completed Step 6, so that these files exist in the&nbsp;<code class="markup--code markup--p-code">./data</code> folder.</p><p name="c525" id="c525" class="graf graf--p graf-after--p">From the command line, run:</p><pre name="d757" id="d757" class="graf graf--pre graf-after--p">python 04_train_rnn.py --start_batch 0 --max_batch 9 --new_model</pre><p name="2102" id="2102" class="graf graf--p graf-after--pre">This will train a new RNN on each batch of data from 0 to 9.</p><p name="6856" id="6856" class="graf graf--p graf-after--p">The model weights will be saved to&nbsp;<code class="markup--code markup--p-code">./rnn/weights.h5</code>. The <code class="markup--code markup--p-code">--new_model</code> flag tells the script to train the model from scratch.</p><p name="2939" id="2939" class="graf graf--p graf-after--p">Similarly to the VAE, if there is an existing <code class="markup--code markup--p-code">weights.h5</code> in this folder and the <code class="markup--code markup--p-code">--new_model</code> flag is not specified, the script will load the weights from this file and continue training the existing model. This way, you can iteratively train your RNN in batches, rather than all in one go.</p><p name="c537" id="c537" class="graf graf--p graf-after--p">The RNN architecture specification is in the&nbsp;<code class="markup--code markup--p-code">./rnn/arch.py</code> file.</p><figure name="786a" id="786a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*OlZ4gIht9DTeBTQr1gfZEg.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_OlZ4gIht9DTeBTQr1gfZEg.png"></div></figure><h3 name="f5d8" id="f5d8" class="graf graf--h3 graf-after--figure">Step 8: Train the Controller</h3><p name="5985" id="5985" class="graf graf--p graf-after--h3">Now for the fun part!</p><p name="79a0" id="79a0" class="graf graf--p graf-after--p">So far, we’ve just used deep learning to build a VAE that can condense high dimension images down to a low dimensional latent space and an RNN that can predict how the latent space will evolve over time. This was possible because we were able to create a training set for each, using random rollout data.</p><p name="4ca0" id="4ca0" class="graf graf--p graf-after--p">To train the controller, we’ll use a form of reinforcement learning, that utilises an evolutionary algorithm known called <strong class="markup--strong markup--p-strong">CMA-ES (Covariance Matrix Adaptation — Evolution Strategy)</strong>.</p><p name="13c5" id="13c5" class="graf graf--p graf-after--p">Since the input is a vector of dimension 288 (= 32 + 256) and the output a vector of dimension 3, we have 288 * 3 + 1 (bias) = 867 parameters to train.</p><figure name="ea0a" id="ea0a" class="graf graf--figure graf--layoutOutsetLeft graf-after--p" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 394px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*405ZycvL6eDyHc33OeYqmw.gif" data-width="1100" data-height="825" data-action="zoom" data-action-value="1*405ZycvL6eDyHc33OeYqmw.gif" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_405ZycvL6eDyHc33OeYqmw.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="55"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/600/1*405ZycvL6eDyHc33OeYqmw.gif" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_405ZycvL6eDyHc33OeYqmw(1).gif"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/600/1*405ZycvL6eDyHc33OeYqmw.gif"&gt;</noscript></div></div></figure><p name="096d" id="096d" class="graf graf--p graf-after--figure">CMA-ES works by first creating multiple randomly initialised copies of the 867 parameters (the ‘population’). It then tests each member of the population inside the environment and records its average score. In exactly the same principle as natural selection, the weights that generate the highest scores are allowed to ‘reproduce’ and spawn the next generation.</p><p name="f2d2" id="f2d2" class="graf graf--p graf-after--p">To start this process on your machine, run the following command, with the appropriate values for the arguments</p><pre name="c0f2" id="c0f2" class="graf graf--pre graf-after--p">python 05_train_controller.py car_racing --num_worker 16 --num_worker_trial 2 --num_episode 4 --max_length 1000 --eval_steps 25</pre><p name="3eef" id="3eef" class="graf graf--p graf-after--pre">or on a server without display:</p><pre name="1737" id="1737" class="graf graf--pre graf-after--p">xvfb-run -s "-screen 0 1400x900x24" python 05_train_controller.py car_racing --num_worker 16 --num_worker_trial 2 --num_episode 4 --max_length 1000 --eval_steps 25</pre><p name="c794" id="c794" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">--num_worker 16</code>&nbsp;: set this to no more than number of cores available</p><p name="aa44" id="aa44" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--num_work_trial 2</code>&nbsp;: the number of members of the population that each worker will test (<code class="markup--code markup--p-code">num_worker * num_work_trial</code> gives the total population size for each generation)</p><p name="7993" id="7993" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--num_episode 4</code>&nbsp;: the number of episodes each member of the population will be scored against (i.e. the score will be the average reward across this number of episodes)</p><p name="84c1" id="84c1" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--max_length 1000</code>&nbsp;: the maximum number of time-steps in an episode</p><p name="d5d9" id="d5d9" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--eval_steps 25</code>: the number of generations between the evaluation of the best set of weights, across 100 episodes</p><p name="53fb" id="53fb" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--init_opt&nbsp;./controller/car_racing.cma.4.32.es.pk</code> By default, the controller will start from scratch each time it is run and save the current state of the process to a pickle file in the <code class="markup--code markup--p-code">controller</code> directory. This argument allows you to continue training from the last save point, by pointing it at the relevant file.</p><p name="e5a2" id="e5a2" class="graf graf--p graf-after--p">After each generation, the current state of the algorithm and the best set of weights will be output to the&nbsp;<code class="markup--code markup--p-code">./controller</code> folder.</p><figure name="7dcc" id="7dcc" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*T3ze0CbMI9EgQSYi1xExhw.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_T3ze0CbMI9EgQSYi1xExhw.png"></div></figure><h3 name="ec27" id="ec27" class="graf graf--h3 graf-after--figure">Step 9: Visualise agent</h3><p name="76db" id="76db" class="graf graf--p graf-after--h3">At the point of writing, I’ve managed to train an agent to achieve an average score of <strong class="markup--strong markup--p-strong">~833.13</strong> after 200 generations of training. This was trained on Google Cloud using an Ubuntu 16.04, 18 vCPU, 67.5GB RAM machine with the steps and parameters given in this tutorial.</p><p name="4cdc" id="4cdc" class="graf graf--p graf-after--p">The authors of the paper managed to achieve an average score of <strong class="markup--strong markup--p-strong">~906</strong>, after 2000 generations of training, which is believed to be the highest score in this environment to date. This utilised a slightly higher spec set-up (e.g. 10,000 episodes of training data, 64 population size, 64 core machine, 16 episodes per trial etc.)</p><p name="e01e" id="e01e" class="graf graf--p graf-after--p">To visualise the current state of your Controller, simply run:</p><pre name="2e0b" id="2e0b" class="graf graf--pre graf-after--p">python model.py car_racing --filename ./controller/car_racing.cma.4.32.best.json --render_mode --record_video</pre><p name="4f3f" id="4f3f" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">--filename</code>&nbsp;: the path to the json of weights that you want to attach to the controller</p><p name="b32b" id="b32b" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--render_mode</code>&nbsp;: render the environment on your screen</p><p name="5033" id="5033" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--record_video</code>&nbsp;: outputs mp4 files into the&nbsp;<code class="markup--code markup--p-code">./video</code> folder, showing each episode</p><p name="934c" id="934c" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">--final_mode</code>&nbsp;: run a 100 episode test of your controller and output the average score.</p><p name="bd3d" id="bd3d" class="graf graf--p graf-after--p">Here’s a demo!</p><figure name="cdbf" id="cdbf" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 600px; max-height: 400px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*-N0F3x2Z3RDvdjEx2rldVg.gif" data-width="600" data-height="400" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_-N0F3x2Z3RDvdjEx2rldVg.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*-N0F3x2Z3RDvdjEx2rldVg.gif" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_-N0F3x2Z3RDvdjEx2rldVg(1).gif"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*-N0F3x2Z3RDvdjEx2rldVg.gif"&gt;</noscript></div></div></figure><figure name="a823" id="a823" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 80px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><img class="graf-image" data-image-id="1*8FybAfsBx6GLBLiY2RDY6g.png" data-width="80" data-height="80" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_8FybAfsBx6GLBLiY2RDY6g.png"></div></figure><h3 name="c9f1" id="c9f1" class="graf graf--h3 graf-after--figure">Step 10: Hallucinogenic Learning</h3><p name="b291" id="b291" class="graf graf--p graf-after--h3">That’s already pretty cool — but the next part of the paper is mind-blowingly impressive and I think has major implications for AI.</p><p name="ddbf" id="ddbf" class="graf graf--p graf-after--p">The paper goes on to show an amazing result, through another environment, <a href="https://github.com/ppaquette/gym-doom" data-href="https://github.com/ppaquette/gym-doom" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">DoomTakeCover</a>. The object here is to move an agent to avoid fireballs and stay alive as long as possible.</p><p name="0338" id="0338" class="graf graf--p graf-after--p">The authors show how it is possible for the agent to actually <strong class="markup--strong markup--p-strong">learn how to play the game within its own VAE / RNN inspired hallucinogenic dreams</strong>, rather than inside the environment itself.</p><p name="f27d" id="f27d" class="graf graf--p graf-after--p graf--trailing">The only required addition is that the RNN is trained to also predict the probability of being killed in the next time-step. This way, the VAE / RNN combination can be wrapped up as an environment in its own right and used to train the Controller. This is the very concept of a ‘<strong class="markup--strong markup--p-strong">World Model</strong>’.</p></div></div></section><section name="a7e1" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="14bc" id="14bc" class="graf graf--p graf--leading">We could summarise the hallucinogenic learning as follows:</p><blockquote name="c004" id="c004" class="graf graf--blockquote graf-after--p">The agent’s initial training data is nothing more than random interactions with the real environment. Through this, it builds up a latent understanding of how the world ‘works’ — its natural groupings, physics and how its own actions affect the state of the world.</blockquote><blockquote name="88ba" id="88ba" class="graf graf--blockquote graf-after--blockquote">It can then use this understanding to establish an optimal strategy for a given task, without ever having to actually test it in the real world, because it can use its own mental model of the environment as the ‘playground’ for trying things out.</blockquote><p name="a56c" id="a56c" class="graf graf--p graf-after--blockquote">This could easily be a description of a baby learning to walk. There are striking similarities that perhaps run deeper than mere analogy, making this a truly fascinating area of research.</p><h3 name="9a8c" id="9a8c" class="graf graf--h3 graf-after--p">Summary</h3><p name="d441" id="d441" class="graf graf--p graf-after--h3">Hopefully you find this article useful — let me know in the comments below if you find any typos or have questions about anything in the codebase or article and I’ll get back to you as soon as possible.</p><figure name="2e7f" id="2e7f" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 195px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 27.800000000000004%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*eDhCRrmRljKt6DegLuwgUg.png" data-width="1194" data-height="332" data-action="zoom" data-action-value="1*eDhCRrmRljKt6DegLuwgUg.png" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_eDhCRrmRljKt6DegLuwgUg.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="20"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*eDhCRrmRljKt6DegLuwgUg.png" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_eDhCRrmRljKt6DegLuwgUg(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*eDhCRrmRljKt6DegLuwgUg.png"&gt;</noscript></div></div></figure><p name="6819" id="6819" class="graf graf--p graf-after--figure">If you would like to learn more about how our company, <a href="https://applied-data.science/" data-href="https://applied-data.science" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Applied Data Science</a> develops innovative data science solutions for businesses, feel free to get in touch through our <a href="https://applied-data.science/" data-href="https://applied-data.science" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">website</a> or directly through <a href="https://www.linkedin.com/in/davidtfoster/" data-href="https://www.linkedin.com/in/davidtfoster/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">LinkedIn</a>.</p><p name="6137" id="6137" class="graf graf--p graf-after--p graf--trailing"><em class="markup--em markup--p-em">… and if you like this, feel free to leave a few hearty claps&nbsp;:)</em></p></div></div></section><section name="d461" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="5ff9" id="5ff9" class="graf graf--p graf--leading"><em class="markup--em markup--p-em">Applied Data Science is a London based consultancy that implements end-to-end data science solutions for businesses, delivering measurable value. If you’re looking to do more with your data, let’s talk.</em></p><figure name="6714" id="6714" class="graf graf--figure graf-after--p graf--trailing"><div class="aspectRatioPlaceholder is-locked" style="max-width: 643px; max-height: 192px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*39gZCiEY2D2vJRzmrYQVNA.png" data-width="643" data-height="192" data-scroll="native"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_39gZCiEY2D2vJRzmrYQVNA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="20"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*39gZCiEY2D2vJRzmrYQVNA.png" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_39gZCiEY2D2vJRzmrYQVNA(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*39gZCiEY2D2vJRzmrYQVNA.png"&gt;</noscript></div></div></figure></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/artificial-intelligence?source=post" data-action-source="post">Artificial Intelligence</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/deep-learning?source=post" data-action-source="post">Deep Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/data-science?source=post" data-action-source="post">Data Science</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/google?source=post" data-action-source="post">Google</a></li></ul></div></div></div><section class="uiScale uiScale-ui--small uiScale-caption--regular u-borderTopLightest u-marginTop10 u-paddingTop20"><div class="ui-h3 u-textColorDarker u-fontSize22">Like what you read? Give David Foster a round of applause.</div><p class="ui-body u-marginBottom20 u-textColorDark u-fontSize16">From a quick cheer to a standing ovation, clap to show how much you enjoyed this story.</p></section><div class="postActions js-postActionsFooter"><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="64fb388ba459" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----64fb388ba459---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/64fb388ba459" data-action-source="post_actions_footer-----64fb388ba459---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="64fb388ba459"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="64fb388ba459">3K</button></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">10</button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="2d3c4b088dc6"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/2d3c4b088dc6" data-action-source="footer_card-2d3c4b088dc6-------------------------follow_footer"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@dtfoster?source=footer_card" title="Go to the profile of David Foster" aria-label="Go to the profile of David Foster" data-action-source="footer_card" data-user-id="2d3c4b088dc6" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_QqMD1rth7ahcS7Gc415R9w.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of David Foster"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@dtfoster" property="cc:attributionName" title="Go to the profile of David Foster" aria-label="Go to the profile of David Foster" rel="author cc:attributionUrl" data-user-id="2d3c4b088dc6" dir="auto">David Foster</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Co-founder of Applied Data Science</p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton" data-action="sign-up-prompt" data-sign-in-action="toggle-follow-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/applied-data-science" data-action-source="----70cd67c5d0e----------------------follow_footer" data-collection-id="70cd67c5d0e"><span class="button-label  js-buttonLabel">Follow</span></button></div><div class="u-tableCell "><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/applied-data-science?source=footer_card" title="Go to Applied Data Science" aria-label="Go to Applied Data Science" data-action-source="footer_card"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_KAi60U6aOWD27X9CFI369A.png" class="avatar-image u-size60x60" alt="Applied Data Science"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/applied-data-science?source=footer_card" rel="collection" data-action-source="footer_card">Applied Data Science</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Cutting edge data science news and projects</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="bfcdd806bf9e" data-source="placement_card_footer_grid---------0-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://towardsdatascience.com/random-initialization-for-neural-networks-a-thing-of-the-past-bfcdd806bf9e?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/0*_4dBjBNyNntW-Iuy.&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://towardsdatascience.com/random-initialization-for-neural-networks-a-thing-of-the-past-bfcdd806bf9e?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Random Initialization For Neural Networks : A Thing Of The Past</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://towardsdatascience.com/@adityaananthram" data-action="show-user-card" data-action-value="6957ea9fb8dc" data-action-type="hover" data-user-id="6957ea9fb8dc" data-collection-slug="towards-data-science" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_U2cYMfFAOOmjoBFjdqaBOw.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Aditya Ananthram"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://towardsdatascience.com/@adityaananthram?source=placement_card_footer_grid---------0-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-60" data-action-value="6957ea9fb8dc" data-action-type="hover" data-user-id="6957ea9fb8dc" data-collection-slug="towards-data-science" dir="auto">Aditya Ananthram</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="bfcdd806bf9e" data-is-label-padded="true" data-source="placement_card_footer_grid-----bfcdd806bf9e----0-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/bfcdd806bf9e" data-action-source="placement_card_footer_grid-----bfcdd806bf9e----0-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="bfcdd806bf9e">1.2K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/bfcdd806bf9e" data-action-source="placement_card_footer_grid-----bfcdd806bf9e----0-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="9a0bff37854e" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@ageitgey/natural-language-processing-is-fun-9a0bff37854e?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*CtR2lIHDkhB9M8Jt4irSyg.gif&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/@ageitgey/natural-language-processing-is-fun-9a0bff37854e?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Machine Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Natural Language Processing is Fun!</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@ageitgey" data-action="show-user-card" data-action-value="ba4c55e4aa3d" data-action-type="hover" data-user-id="ba4c55e4aa3d" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/0_qaGRl18oAZnJiPjb.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Adam Geitgey"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@ageitgey?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="ba4c55e4aa3d" data-action-type="hover" data-user-id="ba4c55e4aa3d" dir="auto">Adam Geitgey</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="16 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="9a0bff37854e" data-is-label-padded="true" data-source="placement_card_footer_grid-----9a0bff37854e----1-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/9a0bff37854e" data-action-source="placement_card_footer_grid-----9a0bff37854e----1-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="9a0bff37854e">1.7K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/9a0bff37854e" data-action-source="placement_card_footer_grid-----9a0bff37854e----1-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="c639ccf36a" data-source="placement_card_footer_grid---------2-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://towardsdatascience.com/stochastic-weight-averaging-a-new-way-to-get-state-of-the-art-results-in-deep-learning-c639ccf36a?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*-EZtClthC4fmDo45tjNXZA.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://towardsdatascience.com/stochastic-weight-averaging-a-new-way-to-get-state-of-the-art-results-in-deep-learning-c639ccf36a?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Stochastic Weight Averaging — a New Way to Get State of the Art Results in Deep Learning</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://towardsdatascience.com/@pechyonkin" data-action="show-user-card" data-action-value="38025716cba8" data-action-type="hover" data-user-id="38025716cba8" data-collection-slug="towards-data-science" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_5EaA2TeJHxPipyjbYnKAsw.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Max Pechyonkin"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://towardsdatascience.com/@pechyonkin?source=placement_card_footer_grid---------2-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-60" data-action-value="38025716cba8" data-action-type="hover" data-user-id="38025716cba8" data-collection-slug="towards-data-science" dir="auto">Max Pechyonkin</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="8 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="c639ccf36a" data-is-label-padded="true" data-source="placement_card_footer_grid-----c639ccf36a----2-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/c639ccf36a" data-action-source="placement_card_footer_grid-----c639ccf36a----2-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="c639ccf36a">3.7K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/c639ccf36a" data-action-source="placement_card_footer_grid-----c639ccf36a----2-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-up-prompt" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459#--respond" data-skip-onboarding="true" data-action-source="logged_out_response_prompt--------------------------respond_box"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div><div class="responsesStream js-responsesStream"><div class="streamItem streamItem--postPreview js-streamItem" data-action-scope="_actionscope_6"><div class="cardChromeless u-marginTop20 u-paddingTop10 u-paddingBottom15 u-paddingLeft20 u-paddingRight20"><div class="postArticle postArticle--short js-postArticle js-trackedPost" data-post-id="cc270f8dd87b" data-source="responses---------0-31--------------------" data-action-scope="_actionscope_7" data-scroll="native"><div class="u-marginBottom10"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@dtfoster" data-action="show-user-card" data-action-value="2d3c4b088dc6" data-action-type="hover" data-user-id="2d3c4b088dc6" dir="auto">David Foster</a> (author)</div></div><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@boucher" data-action="show-user-card" data-action-value="9c8f09c24ec9" data-action-type="hover" data-user-id="9c8f09c24ec9" dir="auto"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/0_9Y_bov_BCEM-wFDU.JPG" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Ross Boucher"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@boucher?source=responses---------0-31--------------------" data-action="show-user-card" data-action-source="responses---------0-31--------------------" data-action-value="9c8f09c24ec9" data-action-type="hover" data-user-id="9c8f09c24ec9" dir="auto">Ross Boucher</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@boucher/you-need-to-specify-car-racing-as-the-env-to-get-the-repo-to-work-as-it-is-now-cc270f8dd87b?source=responses---------0-31--------------------" data-action="open-post" data-action-value="https://medium.com/@boucher/you-need-to-specify-car-racing-as-the-env-to-get-the-repo-to-work-as-it-is-now-cc270f8dd87b?source=responses---------0-31--------------------" data-action-source="preview-listing"><time datetime="2018-04-17T22:29:18.045Z">Apr 18</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@boucher/you-need-to-specify-car-racing-as-the-env-to-get-the-repo-to-work-as-it-is-now-cc270f8dd87b?source=responses---------0-31--------------------" data-action-source="responses---------0-31--------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><pre name="2fb7" id="2fb7" class="graf graf--pre graf--leading">python 01_generate_data.py --total_episodes 200 --start_batch 0 --time_steps 300 car_racing</pre><p name="43dd" id="43dd" class="graf graf--p graf-after--pre graf--trailing">You need to specify “car_racing” as the env to get the repo to work as it is now.</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="cc270f8dd87b" data-is-flush-left="true" data-source="listing-----cc270f8dd87b---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/cc270f8dd87b" data-action-source="listing-----cc270f8dd87b---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="cc270f8dd87b">59</button></span></div></div><div class="buttonSet u-floatRight"><a class="button button--chromeless u-baseColor--buttonNormal" href="https://medium.com/@boucher/you-need-to-specify-car-racing-as-the-env-to-get-the-repo-to-work-as-it-is-now-cc270f8dd87b?source=responses---------0-31--------------------#--responses" data-action-source="responses---------0-31--------------------">1 response</a><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/cc270f8dd87b" data-action-source="listing-----cc270f8dd87b---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1000 js-postLeftSidebar"><div class="u-foreground u-top0 u-sm-hide u-marginLeftNegative12 js-postShareWidget u-transition--fadeIn300 u-fixed" data-scroll="fixed" style="transform: translateY(150px);"><ul><li class="u-textAlignCenter u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="64fb388ba459" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_share_widget-----64fb388ba459---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/64fb388ba459" data-action-source="post_share_widget-----64fb388ba459---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="64fb388ba459"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto" data-action="show-recommends" data-action-value="64fb388ba459">3K</button></span></div></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/64fb388ba459" data-action-source="post_share_widget-----64fb388ba459---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></aside><div class="u-fixed u-bottom0 u-sizeFullWidth u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/applied-data-science" title="Go to Applied Data Science" aria-label="Go to Applied Data Science"><img src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/1_KAi60U6aOWD27X9CFI369A(1).png" class="avatar-image avatar-image--smaller" alt="Applied Data Science"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Applied Data Science</strong>, when you sign up for Medium. <a class="link u-baseColor--link link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Applied Data Science</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><button class="button button--primary button--dark is-active u-noUserSelect button--withChrome u-accentColor--buttonDark u-uiTextSemibold u-textUppercase u-fontSize12 button--followCollection js-followCollectionButton" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/applied-data-science" data-action-source="sticky_footer----70cd67c5d0e----------------------follow_metabar"><span class="button-label  button-defaultState js-buttonLabel">Get updates</span><span class="button-label button-activeState">Get updates</span></button></div></div></div><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #818398 !important;}
.u-accentColor--borderNormal {border-color: #818398 !important;}
.u-accentColor--borderDark {border-color: #6F7181 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #818398 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #818398 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #6F7181 !important;}
.u-accentColor--textNormal {color: #6F7181 !important;}
.u-accentColor--hoverTextNormal:hover {color: #6F7181 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #666776 !important;}
.u-accentColor--textDark {color: #666776 !important;}
.u-accentColor--backgroundLight {background-color: #818398 !important;}
.u-accentColor--backgroundNormal {background-color: #818398 !important;}
.u-accentColor--backgroundDark {background-color: #6F7181 !important;}
.u-accentColor--buttonDark {border-color: #6F7181 !important; color: #666776 !important;}
.u-accentColor--buttonDark:hover {border-color: #666776 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #6F7181 !important; fill: #6F7181 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #818398 !important; color: #6F7181 !important;}
.u-accentColor--buttonNormal:hover {border-color: #6F7181 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #818398 !important; fill: #818398 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #6F7181 !important; border-color: #6F7181 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #818398 !important; border-color: #818398 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #6F7181 !important;}.u-tintBgColor {background-color: rgba(41, 43, 60, 1) !important;}.u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(41, 43, 60, 1) 0%, rgba(41, 43, 60, 0) 100%) !important;}.u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(41, 43, 60, 0) 0%, rgba(41, 43, 60, 1) 100%) !important;}
.u-tintSpectrum .u-baseColor--borderLight {border-color: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--borderNormal {border-color: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--borderDark {border-color: #EEECF2 !important;}
.u-tintSpectrum .u-baseColor--iconLight .svgIcon,.u-tintSpectrum .u-baseColor--iconLight.svgIcon {fill: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--iconNormal .svgIcon,.u-tintSpectrum .u-baseColor--iconNormal.svgIcon {fill: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--iconDark .svgIcon,.u-tintSpectrum .u-baseColor--iconDark.svgIcon {fill: #EEECF2 !important;}
.u-tintSpectrum .u-baseColor--textNormal {color: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--textDark {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--textDarker {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--backgroundLight {background-color: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--backgroundNormal {background-color: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--backgroundDark {background-color: #EEECF2 !important;}
.u-tintSpectrum .u-baseColor--buttonLight {border-color: #9F9FAB !important; color: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--buttonLight:hover {border-color: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--buttonLight .icon:before,.u-tintSpectrum .u-baseColor--buttonLight .svgIcon {color: #9F9FAB !important; fill: #9F9FAB !important;}
.u-tintSpectrum .u-baseColor--buttonDark {border-color: #EEECF2 !important; color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark:hover {border-color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark .icon:before,.u-tintSpectrum .u-baseColor--buttonDark .svgIcon {color: #EEECF2 !important; fill: #EEECF2 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal {border-color: #C7C7D0 !important; color: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal:hover {border-color: #EEECF2 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal .icon:before,.u-tintSpectrum .u-baseColor--buttonNormal .svgIcon {color: #C7C7D0 !important; fill: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--buttonDark.button--filled,.u-tintSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: #EEECF2 !important; border-color: #EEECF2 !important; color: rgba(41, 43, 60, 1) !important; fill: rgba(41, 43, 60, 1) !important;}
.u-tintSpectrum .u-baseColor--buttonNormal.button--filled,.u-tintSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: #C7C7D0 !important; border-color: #C7C7D0 !important; color: rgba(41, 43, 60, 1) !important; fill: rgba(41, 43, 60, 1) !important;}
.u-tintSpectrum .u-baseColor--link {color: #C7C7D0 !important;}
.u-tintSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--darken:active {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:active {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darker {color: #FFFEFF !important;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: #9F9FAB;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: #9F9FAB;}
.u-tintSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: #9F9FAB;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: #5D5E6E !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: #747584 !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: #9F9FAB !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: #C7C7D0 !important;}
.u-tintSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: #FFFEFF !important;}
.u-tintSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: #FFFEFF !important;}
.u-tintSpectrum  .ui-h1,.u-tintSpectrum  .ui-h2,.u-tintSpectrum  .ui-h3,.u-tintSpectrum  .ui-h4,.u-tintSpectrum  .ui-brand1,.u-tintSpectrum  .ui-brand2,.u-tintSpectrum  .ui-captionStrong {color: #FFFEFF !important; fill: #FFFEFF !important;}
.u-tintSpectrum  .ui-body,.u-tintSpectrum  .ui-caps {color: #FFFEFF !important; fill: #FFFEFF !important;}
.u-tintSpectrum  .ui-summary,.u-tintSpectrum  .ui-caption {color: #9F9FAB !important; fill: #9F9FAB !important;}
.u-tintSpectrum .u-accentColor--borderLight {border-color: #9F9FAB !important;}
.u-tintSpectrum .u-accentColor--borderNormal {border-color: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--borderDark {border-color: #EEECF2 !important;}
.u-tintSpectrum .u-accentColor--iconLight .svgIcon,.u-tintSpectrum .u-accentColor--iconLight.svgIcon {fill: #9F9FAB !important;}
.u-tintSpectrum .u-accentColor--iconNormal .svgIcon,.u-tintSpectrum .u-accentColor--iconNormal.svgIcon {fill: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--iconDark .svgIcon,.u-tintSpectrum .u-accentColor--iconDark.svgIcon {fill: #EEECF2 !important;}
.u-tintSpectrum .u-accentColor--textNormal {color: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--hoverTextNormal:hover {color: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #FFFEFF !important;}
.u-tintSpectrum .u-accentColor--textDark {color: #FFFEFF !important;}
.u-tintSpectrum .u-accentColor--backgroundLight {background-color: #9F9FAB !important;}
.u-tintSpectrum .u-accentColor--backgroundNormal {background-color: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--backgroundDark {background-color: #EEECF2 !important;}
.u-tintSpectrum .u-accentColor--buttonDark {border-color: #EEECF2 !important; color: #FFFEFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark:hover {border-color: #FFFEFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark .icon:before,.u-tintSpectrum .u-accentColor--buttonDark .svgIcon{color: #EEECF2 !important; fill: #EEECF2 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #C7C7D0 !important; color: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:hover {border-color: #EEECF2 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal .svgIcon{color: #C7C7D0 !important; fill: #C7C7D0 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(41, 43, 60, 1) !important; fill: rgba(41, 43, 60, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonDark.button--filled,.u-tintSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-tintSpectrum .u-accentColor--fillWhenActive.is-active {background-color: #EEECF2 !important; border-color: #EEECF2 !important; color: rgba(41, 43, 60, 1) !important; fill: rgba(41, 43, 60, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-tintSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #C7C7D0 !important; border-color: #C7C7D0 !important; color: rgba(41, 43, 60, 1) !important; fill: rgba(41, 43, 60, 1) !important;}
.u-tintSpectrum .postArticle.is-withAccentColors .markup--user,.u-tintSpectrum .postArticle.is-withAccentColors .markup--query {color: #C7C7D0 !important;}
.u-accentColor--highlightFaint {background-color: rgba(241, 240, 246, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(222, 222, 240, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(241, 240, 246, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(241, 240, 246, 1), rgba(241, 240, 246, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(231, 230, 243, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(231, 230, 243, 1), rgba(231, 230, 243, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(222, 222, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(222, 222, 240, 1), rgba(222, 222, 240, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(222, 222, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(222, 222, 240, 1), rgba(222, 222, 240, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(222, 222, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(222, 222, 240, 1), rgba(222, 222, 240, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(255, 255, 255, 0.4) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(255, 255, 255, 0.4980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(0, 0, 0, 0.4) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-up-prompt" data-sign-in-action="quote" data-requires-token="true" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-skip-onboarding="true" data-redirect-type="quote" data-action-source="quote_menu--------------------------highlight_text"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="quote-respond" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-skip-onboarding="true" data-action-source="quote_menu--------------------------respond_text"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="twitter" data-action-source="quote_menu" data-skip-onboarding="true"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="highlight" data-redirect="https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459" data-skip-onboarding="true" data-action-source="quote_menu--------------------------privatenote_text"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"34384-06880fc","currentUser":{"userId":"lo_6eca48311aab","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":false,"isWriterProgramInvited":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.OMufPCKOxcdmn6e8fEgNwA.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.WKmfPf9Nj8xCneCN6TKlEA.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.J1LdPcKQQAJX5xpUr9JlHw.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.uFpbgBPVWU56lFaZxMKGmA.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.lmjI44rCYNw7APIuFkgCKw.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.LUI7G9sM3rPgZyAJHfZQig.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.ghA0udvsSqbDfvX-ckuD6A.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.57QRNU1BfrSMdM-WpNe7Sg.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.lwckzszqYwk2NVI0fozq9w.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.a77_gnc2_l0h4MDX_wWs2A.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.cCr1yik17VVu8kO_biEXoA.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1532089940576:79486e90f1a4","useragent":{"browser":"chrome","family":"chrome","os":"","version":65,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":1,"isSearchBot":false,"isSyndicationBot":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"disable_followed_tag_fan_out":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_sequence_carousel":true,"enable_multirecommends":true,"enable_post_monger_v2":true,"enable_post_monger_v3":true,"enable_fastrak_beta":true,"enable_fastrak_lock_tiered_post_in_pub":true,"enable_user_post_metering":true,"enable_direct_upsell_expanded_in_meter":true,"max_premium_content_per_user_under_metering":3,"tag_intercom_user_on_metering_count":3,"enable_automated_mission_control_triggers":true,"enable_topic_writer_onboarding":true,"enable_strong_graph_chp_reorder":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_lite_profile":true,"enable_li_search_collection":true,"enable_homepage_remodel":true,"enable_signin_wall_custom_domain":true,"app_download_email_template":"control","enable_topic_lifecycle_email":true,"enable_marketing_emails":true,"enable_curation_post_locking":true,"ios_hide_avatars_on_home":true,"raise_editors_picks_digest":"control","android_disable_author_avatars":true,"enable_quality_pool_filters":true,"enable_truncated_rss_for_tags_and_topics":true,"enable_ios_related_reads_api_change":true,"enable_ios_related_reads_ui_large":true,"enable_ios_responses_collapsed":true,"enable_hightower_friend_link":true,"enable_rex_service_homefeed":true,"enable_parsely":true,"enable_curation_master_feed":true,"enable_july_meter_email_test":true,"enable_app_metered_out_promo":true,"enable_send_editors_picks_to_all_users":true,"accelerate_membership_headline_test":"coffee-headline"},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/elv8.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"3e0c2f6918972f4c\",\"ot-tracer-traceid\":\"0ce83748028ba43a\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":1,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"lo_post_page_4","type":0,"url":"www.calendly.com"},{"promptId":"lo_home_page","type":1,"url":"www.calendly.com"},{"promptId":"lo_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","paypalClientMode":"production","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"ET","bypassMeter":false}
// ]]></script><script charset="UTF-8" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/main-base.bundle.OMufPCKOxcdmn6e8fEgNwA.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"64fb388ba459","versionId":"f85f30ffba13","creatorId":"2d3c4b088dc6","creator":{"userId":"2d3c4b088dc6","name":"David Foster","username":"dtfoster","createdAt":1487612215156,"lastPostCreatedAt":1527088695667,"imageId":"1*QqMD1rth7ahcS7Gc415R9w.jpeg","backgroundImageId":"","bio":"Co-founder of Applied Data Science","socialStats":{"userId":"2d3c4b088dc6","usersFollowedCount":67,"usersFollowedByCount":2937,"type":"SocialStats"},"social":{"userId":"lo_6eca48311aab","targetUserId":"2d3c4b088dc6","type":"Social"},"allowNotes":1,"isNsfw":false,"isWriterProgramInvited":false,"isPartnerProgramEnrolled":false,"isWriterProgramEnrolled":false,"type":"User"},"homeCollection":{"id":"70cd67c5d0e","name":"Applied Data Science","slug":"applied-data-science","tags":["ARTIFICIAL INTELLIGENCE","DATA SCIENCE","DEEP LEARNING","MACHINE LEARNING","PYTHON"],"creatorId":"2d3c4b088dc6","description":"Cutting edge data science news and projects","shortDescription":"Cutting edge data science news and projects","image":{"imageId":"1*KAi60U6aOWD27X9CFI369A.png","filter":"","backgroundSize":"","originalWidth":512,"originalHeight":512,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":3024,"activeAt":1523980580383},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*2A6OcWvQBoboXH2AW0LQMw.png","filter":"","backgroundSize":"","originalWidth":1378,"originalHeight":410,"strategy":"resample","height":0,"width":0},"twitterUsername":"applied_data","publicEmail":"info@applied-data.science","sections":[{"type":2,"collectionHeaderMetadata":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"e1155640b5e1"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":11,"postIds":[]}}],"tintColor":"#FF292B3C","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF818398","point":0},{"color":"#FF787A8C","point":0.1},{"color":"#FF6F7181","point":0.2},{"color":"#FF666776","point":0.3},{"color":"#FF5D5E6A","point":0.4},{"color":"#FF53535E","point":0.5},{"color":"#FF484952","point":0.6},{"color":"#FF3E3E46","point":0.7},{"color":"#FF323339","point":0.8},{"color":"#FF27272B","point":0.9},{"color":"#FF1A1A1D","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF292B3C","point":0},{"color":"#FF444656","point":0.1},{"color":"#FF5D5E6E","point":0.2},{"color":"#FF747584","point":0.3},{"color":"#FF8A8B98","point":0.4},{"color":"#FF9F9FAB","point":0.5},{"color":"#FFB3B3BE","point":0.6},{"color":"#FFC7C7D0","point":0.7},{"color":"#FFDBDAE1","point":0.8},{"color":"#FFEEECF2","point":0.9},{"color":"#FFFFFEFF","point":1}],"backgroundColor":"#FF292B3C"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF3F2F7","point":0},{"color":"#FFF1F0F6","point":0.1},{"color":"#FFEFEEF6","point":0.2},{"color":"#FFEDECF5","point":0.3},{"color":"#FFEBEAF4","point":0.4},{"color":"#FFE9E8F3","point":0.5},{"color":"#FFE7E6F3","point":0.6},{"color":"#FFE4E4F2","point":0.7},{"color":"#FFE2E2F1","point":0.8},{"color":"#FFE0E0F1","point":0.9},{"color":"#FFDEDEF0","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":1,"title":"Blog","tagSlug":"data-science","url":"https://medium.com/applied-data-science/tagged/data-science","source":"tagSlug"},{"type":3,"title":"MAIN SITE","url":"http://applied-data.science"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5},"type":"Collection"},"homeCollectionId":"70cd67c5d0e","title":"Hallucinogenic Deep Reinforcement Learning using Python and Keras","detectedLanguage":"en","latestVersion":"f85f30ffba13","latestPublishedVersion":"f85f30ffba13","hasUnpublishedEdits":false,"latestRev":4114,"createdAt":1523478658832,"updatedAt":1530435179839,"acceptedAt":0,"firstPublishedAt":1523980562741,"latestPublishedAt":1530435179839,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"Teaching a machine to master car racing and fireball avoidance through “World Models”","bodyModel":{"paragraphs":[{"name":"ec2c","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*ynKeQFaQJn4NxmViJW4KAg.gif","originalWidth":386,"originalHeight":186,"isFeatured":true}},{"name":"9477","type":3,"text":"Hallucinogenic Deep Reinforcement Learning Using Python and Keras","markups":[]},{"name":"6c4a","type":13,"text":"Teaching a machine to master car racing and fireball avoidance through “World Models”","markups":[]},{"name":"c552","type":1,"text":"If Artificial Intelligence is your thing, you need to check this out:","markups":[]},{"name":"8b86","type":14,"text":"World Models\nInteractive demo: Tap screen to override the agent's decisions. We explore building generative neural network models of…worldmodels.github.io","markups":[{"type":3,"start":0,"end":154,"href":"https://worldmodels.github.io/","title":"https://worldmodels.github.io/","rel":"","anchorType":0},{"type":1,"start":0,"end":12},{"type":2,"start":13,"end":133}],"mixtapeMetadata":{"mediaResourceId":"5770ecbe3de72f58296083461c71e44a","thumbnailImageId":"0*NQf6CAAmOUPLWPL3.","href":"https://worldmodels.github.io/"}},{"name":"5ad7","type":1,"text":"https://arxiv.org/abs/1803.10122","markups":[{"type":3,"start":0,"end":32,"href":"https://arxiv.org/abs/1803.10122","title":"","rel":"noopener","anchorType":0},{"type":1,"start":0,"end":32}]},{"name":"fa8a","type":1,"text":"In short, it’s a masterpiece, for three reasons:","markups":[]},{"name":"bf75","type":10,"text":"It combines several deep/reinforcement learning techniques to produce an amazing result — the first known agent to solve the popular 'Car Racing' reinforcement learning environment.","markups":[]},{"name":"5793","type":10,"text":"It’s written in a very accessible style, so a great learning resource for anyone interested in cutting-edge AI","markups":[]},{"name":"1b6d","type":10,"text":"You can code the solution yourself","markups":[]},{"name":"cbdc","type":1,"text":"This post is a step by step guide through the paper.","markups":[{"type":1,"start":0,"end":51}]},{"name":"c366","type":1,"text":"We’ll cover the technical details and also walk through how you can get a version running on your own machine.","markups":[]},{"name":"a8da","type":1,"text":"Similarly to my post on AlphaZero, I’m not associated with the authors of the paper but just wanted to share my interpretation of their terrific work.","markups":[{"type":3,"start":24,"end":33,"href":"https://medium.com/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":150}]},{"name":"995b","type":4,"text":"","markups":[],"layout":4,"metadata":{"id":"1*8eLAymZlVovZrB0Vel-nQg.png","originalWidth":1450,"originalHeight":1044},"href":"https://applied-data.science/the-network/"},{"name":"0cea","type":7,"text":"First, a quick note about a new platform, The Network — a place where data scientists can find paid contract projects with businesses!","markups":[]},{"name":"263f","type":7,"text":"Click ‘Register’ to start building your profile.","markups":[]},{"name":"ab0f","type":4,"text":"","markups":[],"layout":3,"metadata":{"id":"1*zv2Hy8IwUKqH2ruz5kFHMg.png","originalWidth":80,"originalHeight":80}},{"name":"af9c","type":3,"text":"Step 1: The Problem","markups":[]},{"name":"5893","type":1,"text":"We’re going to build a reinforcement learning algorithm (an ‘agent’) that gets good at driving a car around a 2D racetrack. This environment (Car Racing) is available through the OpenAI Gym","markups":[{"type":3,"start":179,"end":189,"href":"https://gym.openai.com/","title":"","rel":"","anchorType":0},{"type":1,"start":179,"end":189}]},{"name":"0cc7","type":1,"text":"At each time-step, the algorithm is fed an observation (a 64 x 64 pixel colour image of the car and immediate surroundings) and needs to return the next set of actions to take — specifically, the steering direction (-1 to 1), acceleration (0 to 1) and brake (0 to 1).","markups":[]},{"name":"7356","type":1,"text":"This action is then passed to the environment, which returns the next observation and the cycle starts again.","markups":[]},{"name":"9da6","type":1,"text":"An agent scores 1000/N for each of the N track tiles visited and -0.1 for each time-step taken. For example, if the agent completes the track in 732 frames, the reward is 1000–0.1*732 = 926.8 points.","markups":[]},{"name":"43b7","type":4,"text":"","markups":[],"layout":4,"metadata":{"id":"1*Yil5VbPHSoHcEOrnGOobUQ.gif","originalWidth":600,"originalHeight":400}},{"name":"08d2","type":1,"text":"Here’s an example of an agent that chooses the action [0,1 0] for the first 200 time-steps then something random…not a great driving strategy.","markups":[]},{"name":"4d61","type":1,"text":"The aim is to train the agent to understand that it can use information from its surroundings to inform the next best action.","markups":[]},{"name":"4cec","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*U8VHQ030UBt33BXOGjmtbQ.png","originalWidth":80,"originalHeight":80}},{"name":"f802","type":3,"text":"Step 2: The Solution","markups":[]},{"name":"07f6","type":1,"text":"There is an excellent online interactive explanation of the methodology, written by the authors, so I won’t go into the same level of detail here, but instead will focus on a high-level summary of how the pieces fit together, with an analogy to real driving to explain why the solution intuitively makes sense.","markups":[{"type":3,"start":29,"end":71,"href":"https://worldmodels.github.io/","title":"","rel":"noopener","anchorType":0}]},{"name":"c17e","type":1,"text":"The solution consists of three distinct parts, which are trained separately:","markups":[]},{"name":"bcf0","type":13,"text":"A Variational Autoencoder (VAE)","markups":[]},{"name":"a4e0","type":1,"text":"When you make decisions whilst driving, you don’t actively analyse every single ‘pixel’ in your view — instead your brain condenses the visual information into a smaller number of ‘latent’ entities, such as the straightness of the road, upcoming bends and your position relative to the road, to inform your next action.","markups":[]},{"name":"d670","type":1,"text":"This is exactly what the VAE is trained to do — condense the 64x64x3 (RGB) input image into a 32-dimensional latent vector (z) that follows a Gaussian distribution.","markups":[{"type":1,"start":0,"end":45}]},{"name":"2515","type":1,"text":"This is useful because the agent can now work with a much smaller representation of its surroundings and therefore can be more efficient in its learning.","markups":[]},{"name":"b1e7","type":13,"text":"A Recurrent Neural Network with Mixture Density Network output layer (MDN-RNN)","markups":[{"type":1,"start":0,"end":78}]},{"name":"4d80","type":4,"text":"","markups":[],"layout":4,"metadata":{"id":"1*s-yfIRkx0T_gbS1SYaldkw.gif","originalWidth":480,"originalHeight":433}},{"name":"9f63","type":1,"text":"If you didn’t have an MDN-RNN component to your decision making, your driving might look something like this.","markups":[]},{"name":"d904","type":1,"text":"As you drive, each subsequent observation isn’t a complete surprise to you. You know that if the current observation suggests a left turn in the road and you turn the wheel left, you expect the next observation to show that you are still in line with the road.","markups":[]},{"name":"b270","type":1,"text":"This forward thinking is the job of the RNN — specifically this a Long Short-Term Memory Network (LSTM) with 256 hidden units. The vector of hidden states is represented by h.","markups":[{"type":1,"start":0,"end":43}]},{"name":"a3d9","type":1,"text":"Similarly to the VAE, the RNN tries to capture a latent understanding of the current state of the car in its environment, but this time with the aim of predicting what the next ‘z’ might look like, based on the previous ‘z’ and the previous action.","markups":[]},{"name":"6e04","type":1,"text":"The MDN output layer simply allows for the fact that the next ‘z’ could actually be drawn from any one of several Gaussian distributions.","markups":[]},{"name":"2e4e","type":4,"text":"MDN for handwriting generation","markups":[],"layout":4,"metadata":{"id":"1*pJIaYNT1RWCRUq8IDKz-2Q.png","originalWidth":400,"originalHeight":237}},{"name":"7884","type":1,"text":"The same technique was applied in this article, by the same author, for handwriting generation, to describe the fact that the next pen point could land in any one of the red distinct areas.","markups":[{"type":3,"start":34,"end":38,"href":"http://blog.otoro.net/2015/12/28/recurrent-net-dreams-up-fake-chinese-characters-in-vector-format-with-tensorflow/","title":"","rel":"","anchorType":0}]},{"name":"739e","type":1,"text":"Similarly, in the World Models paper, the next observed latent state could be drawn from any one of five Gaussian distributions.","markups":[]},{"name":"7a75","type":13,"text":"The Controller","markups":[]},{"name":"bf4d","type":1,"text":"Up until this point, we haven’t mentioned anything about choosing an action. That responsibility lies with the Controller.","markups":[]},{"name":"ce87","type":1,"text":"The Controller is simply a densely connected neural network, where the input is a concatenation of z (the current latent state from the VAE — length 32) and h (the hidden state of the RNN — length 256). The 3 output neurons correspond to the three actions and are scaled to fall in the appropriate ranges.","markups":[{"type":1,"start":27,"end":59}]},{"name":"2c4d","type":13,"text":"A dialogue","markups":[]},{"name":"9423","type":1,"text":"To understand the different roles of the three components and how they work together, we can imagine a dialogue between them:","markups":[]},{"name":"07f0","type":4,"text":"Diagram of the World Model architecture (source: https://arxiv.org/pdf/1803.10122.pdf)","markups":[{"type":3,"start":49,"end":85,"href":"https://arxiv.org/pdf/1803.10122.pdf","title":"","rel":"nofollow","anchorType":0}],"layout":1,"metadata":{"id":"1*_iOdKbAgXsHZ6vDIx6sOnw.png","originalWidth":249,"originalHeight":179}},{"name":"b9ff","type":6,"text":"VAE: (looks at latest 64*64*3 observation) This looks like a straight road, with a slight left bend approaching, with the car facing in the direction of the road (z).","markups":[]},{"name":"cb3b","type":6,"text":"RNN: Based on that description (z) and the fact that the Controller chose to accelerate hard at the last time-step (action), I will update my hidden state (h) so that the next observation is predicted to still be a straight road, but with slightly more left turn in view.","markups":[]},{"name":"49d3","type":6,"text":"Controller: Based on the description from the VAE (z) and the current hidden state from the RNN (h) my neural network outputs next action to be [0.34, 0.8, 0].","markups":[]},{"name":"12db","type":1,"text":"This action is then passed to the environment, which returns an updated observation and the cycle begins again.","markups":[]},{"name":"0709","type":1,"text":"We’ll now look at how to set up an environment that allows you to train your own version of the agent for car racing.","markups":[]},{"name":"e14a","type":1,"text":"Time for some code!","markups":[]},{"name":"43e9","type":3,"text":"Step 3: Set up your environment","markups":[]},{"name":"65c6","type":1,"text":"If you’ve got a high-spec laptop, you can run the solution locally, but I’d recommend using Google Cloud Compute for access to powerful machines that you can use in short bursts.","markups":[{"type":3,"start":92,"end":112,"href":"https://cloud.google.com/compute/","title":"","rel":"","anchorType":0}]},{"name":"79c0","type":1,"text":"The following has been tested on Linux (Ubuntu 16.04) — just change the relevant commands for package installation if you’re on Mac or Windows.","markups":[]},{"name":"7a96","type":10,"text":"Clone the repository","markups":[{"type":3,"start":10,"end":20,"href":"https://github.com/AppliedDataSciencePartners/WorldModels","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":20}]},{"name":"cdd5","type":1,"text":"In the command line, navigate to the place you want to store the repository and enter the following:","markups":[]},{"name":"6236","type":8,"text":"git clone https://github.com/AppliedDataSciencePartners/WorldModels.git","markups":[]},{"name":"d166","type":1,"text":"The repository is adapted from the highly useful estool library developed by David Ha, the first author of the World Models paper.","markups":[{"type":3,"start":49,"end":55,"href":"https://github.com/hardmaru/estool","title":"","rel":"noopener","anchorType":0}]},{"name":"dc19","type":1,"text":"For the neural network training, this implementation uses Keras with a Tensorflow backend, though in the original paper the authors used raw Tensorflow.","markups":[{"type":3,"start":58,"end":63,"href":"https://keras.io/","title":"","rel":"noopener","anchorType":0},{"type":3,"start":71,"end":81,"href":"https://www.tensorflow.org/","title":"","rel":"","anchorType":0}]},{"name":"7425","type":1,"text":"2. Set up a virtual environment","markups":[{"type":1,"start":0,"end":31}]},{"name":"3080","type":1,"text":"Create yourself a Python 3 virtual environment (I use virutalenv and virtualenvwrapper)","markups":[]},{"name":"4f67","type":8,"text":"sudo apt-get install python-pip\nsudo pip install virtualenv\nsudo pip install virtualenvwrapper\nexport WORKON_HOME=~/.virtualenvs\nsource /usr/local/bin/virtualenvwrapper.sh\nmkvirtualenv --python=/usr/bin/python3 worldmodels","markups":[]},{"name":"ca65","type":1,"text":"2. Install packages","markups":[{"type":1,"start":0,"end":19}]},{"name":"5c01","type":8,"text":"sudo apt-get install cmake swig python3-dev zlib1g-dev python-opengl mpich xvfb xserver-xephyr vnc4server","markups":[]},{"name":"ca37","type":1,"text":"3. Install requirements.txt","markups":[{"type":1,"start":0,"end":27}]},{"name":"5cc7","type":8,"text":"cd WorldModels\npip install -r requirements.txt","markups":[]},{"name":"b054","type":1,"text":"There are more here than required by the Car Racing example, but you’ll have everything installed in case you want to test out some of the other environments in Open AI gym, that require the additional packages.","markups":[]},{"name":"3c69","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*yRdffHYsR1-cPqqxoKghKg.png","originalWidth":80,"originalHeight":80}},{"name":"6bbd","type":3,"text":"Step 4: Generate random rollouts","markups":[]},{"name":"413d","type":1,"text":"For the Car Racing environment, both the VAE and RNN can be on random rollout data — that is, observation data generated by randomly taking actions at each time-step. Actually, we use pseudo-random actions, which forces the car to accelerate initially, in order to get it off the start line.","markups":[{"type":1,"start":63,"end":69}]},{"name":"46a6","type":1,"text":"Since the VAE and RNN are independent of the decision-making Controller, all we need to ensure is that we encounter a diverse range of observations and choose a diverse range of actions to save as training data.","markups":[]},{"name":"f146","type":1,"text":"To generate the random rollouts, run the following from the command line","markups":[]},{"name":"0cc0","type":8,"text":"python 01_generate_data.py car_racing --total_episodes 2000 --start_batch 0 --time_steps 300","markups":[]},{"name":"9307","type":1,"text":"or if you’re on a server without a display,","markups":[]},{"name":"b63a","type":8,"text":"xvfb-run -a -s \"-screen 0 1400x900x24\" python 01_generate_data.py car_racing --total_episodes 2000 --start_batch 0 --time_steps 300","markups":[]},{"name":"cefc","type":1,"text":"This will produce 2000 rollouts (saved in ten batches of 200), starting with batch number 0. Each rollout will be a maximum of 300 time-steps long","markups":[]},{"name":"e5ee","type":1,"text":"Two sets of files are saved in ./data, (* is the batch number)","markups":[{"type":10,"start":31,"end":37}]},{"name":"f56e","type":1,"text":"obs_data_*.npy (stores the 64*64*3 images as numpy arrays)","markups":[{"type":10,"start":0,"end":14}]},{"name":"1b8f","type":1,"text":"action_data_*.npy (stores the 3 dimensional actions)","markups":[{"type":10,"start":0,"end":18}]},{"name":"26d2","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*cbMhKPxI2aLmQ1semQoRKw.png","originalWidth":80,"originalHeight":80}},{"name":"3a9e","type":3,"text":"Step 5: Train the VAE","markups":[]},{"name":"67a3","type":1,"text":"Training the VAE only requires the obs_data_*.npy files. Make sure you’ve completed Step 4, so that these files exist in the ./data folder.","markups":[{"type":10,"start":35,"end":49},{"type":10,"start":125,"end":131}]},{"name":"585b","type":1,"text":"From the command line, run:","markups":[]},{"name":"c650","type":8,"text":"python 02_train_vae.py --start_batch 0 --max_batch 9 --new_model","markups":[]},{"name":"7120","type":1,"text":"This will train a new VAE on each batch of data from 0 to 9.","markups":[]},{"name":"1427","type":1,"text":"The model weights will be saved to ./vae/weights.h5. The --new_model flag tells the script to train the model from scratch.","markups":[{"type":10,"start":35,"end":51},{"type":10,"start":57,"end":68}]},{"name":"dc8a","type":1,"text":"If there is an existing weights.h5 in this folder and the --new_model flag is not specified, the script will load the weights from this file and continue training the existing model. This way, you can iteratively train your VAE in batches, rather than all in one go.","markups":[{"type":10,"start":24,"end":34},{"type":10,"start":58,"end":69}]},{"name":"1558","type":1,"text":"The VAE architecture specification in the ./vae/arch.py file.","markups":[{"type":10,"start":42,"end":55}]},{"name":"5f17","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*JKOI6lJJqSgJeN1W_25-gw.png","originalWidth":80,"originalHeight":80}},{"name":"e055","type":3,"text":"Step 6: Generate RNN data","markups":[]},{"name":"2044","type":1,"text":"Now that we have a trained VAE, we can use it to generate the training set for the RNN.","markups":[]},{"name":"f9b1","type":1,"text":"The RNN requires encoded image data (z) from the VAE and actions (a) as input and one time-step ahead encoded image data from the VAE as output.","markups":[]},{"name":"c06f","type":1,"text":"You can generate this data by running:","markups":[]},{"name":"d273","type":8,"text":"python 03_generate_rnn_data.py --start_batch 0 --max_batch 9","markups":[]},{"name":"f4e3","type":1,"text":"This will take the obs_data_*.npy and action_data_*.npy files from batches 0 to 9 and convert them to the correct format required by the RNN for training.","markups":[{"type":10,"start":19,"end":33},{"type":10,"start":38,"end":55}]},{"name":"6ce5","type":1,"text":"Two sets of files will be saved in ./data, (* is the batch number)","markups":[{"type":10,"start":35,"end":41}]},{"name":"97f8","type":1,"text":"rnn_input_*.npy (stores the [z a] concatenated vectors)","markups":[{"type":10,"start":0,"end":15}]},{"name":"cc18","type":1,"text":"rnn_output_*.npy (stores the z vector one time-step ahead)","markups":[{"type":10,"start":0,"end":17}]},{"name":"b587","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*MZVrVvObKi4ZxAtiOP0QFw.png","originalWidth":80,"originalHeight":80}},{"name":"263d","type":3,"text":"Step 7: Train the RNN","markups":[]},{"name":"4045","type":1,"text":"Training the RNN only requires the rnn_input_*.npy and rnn_output_*.npy files. Make sure you’ve completed Step 6, so that these files exist in the ./data folder.","markups":[{"type":10,"start":35,"end":50},{"type":10,"start":55,"end":72},{"type":10,"start":147,"end":153}]},{"name":"c525","type":1,"text":"From the command line, run:","markups":[]},{"name":"d757","type":8,"text":"python 04_train_rnn.py --start_batch 0 --max_batch 9 --new_model","markups":[]},{"name":"2102","type":1,"text":"This will train a new RNN on each batch of data from 0 to 9.","markups":[]},{"name":"6856","type":1,"text":"The model weights will be saved to ./rnn/weights.h5. The --new_model flag tells the script to train the model from scratch.","markups":[{"type":10,"start":35,"end":51},{"type":10,"start":57,"end":68}]},{"name":"2939","type":1,"text":"Similarly to the VAE, if there is an existing weights.h5 in this folder and the --new_model flag is not specified, the script will load the weights from this file and continue training the existing model. This way, you can iteratively train your RNN in batches, rather than all in one go.","markups":[{"type":10,"start":46,"end":56},{"type":10,"start":80,"end":91}]},{"name":"c537","type":1,"text":"The RNN architecture specification is in the ./rnn/arch.py file.","markups":[{"type":10,"start":45,"end":58}]},{"name":"786a","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*OlZ4gIht9DTeBTQr1gfZEg.png","originalWidth":80,"originalHeight":80}},{"name":"f5d8","type":3,"text":"Step 8: Train the Controller","markups":[]},{"name":"5985","type":1,"text":"Now for the fun part!","markups":[]},{"name":"79a0","type":1,"text":"So far, we’ve just used deep learning to build a VAE that can condense high dimension images down to a low dimensional latent space and an RNN that can predict how the latent space will evolve over time. This was possible because we were able to create a training set for each, using random rollout data.","markups":[]},{"name":"4ca0","type":1,"text":"To train the controller, we’ll use a form of reinforcement learning, that utilises an evolutionary algorithm known called CMA-ES (Covariance Matrix Adaptation — Evolution Strategy).","markups":[{"type":1,"start":122,"end":180}]},{"name":"13c5","type":1,"text":"Since the input is a vector of dimension 288 (= 32 + 256) and the output a vector of dimension 3, we have 288 * 3 + 1 (bias) = 867 parameters to train.","markups":[]},{"name":"ea0a","type":4,"text":"","markups":[],"layout":4,"metadata":{"id":"1*405ZycvL6eDyHc33OeYqmw.gif","originalWidth":1100,"originalHeight":825}},{"name":"096d","type":1,"text":"CMA-ES works by first creating multiple randomly initialised copies of the 867 parameters (the ‘population’). It then tests each member of the population inside the environment and records its average score. In exactly the same principle as natural selection, the weights that generate the highest scores are allowed to ‘reproduce’ and spawn the next generation.","markups":[]},{"name":"f2d2","type":1,"text":"To start this process on your machine, run the following command, with the appropriate values for the arguments","markups":[]},{"name":"c0f2","type":8,"text":"python 05_train_controller.py car_racing --num_worker 16 --num_worker_trial 2 --num_episode 4 --max_length 1000 --eval_steps 25","markups":[]},{"name":"3eef","type":1,"text":"or on a server without display:","markups":[]},{"name":"1737","type":8,"text":"xvfb-run -s \"-screen 0 1400x900x24\" python 05_train_controller.py car_racing --num_worker 16 --num_worker_trial 2 --num_episode 4 --max_length 1000 --eval_steps 25","markups":[]},{"name":"c794","type":1,"text":"--num_worker 16 : set this to no more than number of cores available","markups":[{"type":10,"start":0,"end":15}]},{"name":"aa44","type":1,"text":"--num_work_trial 2 : the number of members of the population that each worker will test (num_worker * num_work_trial gives the total population size for each generation)","markups":[{"type":10,"start":0,"end":18},{"type":10,"start":89,"end":116}]},{"name":"7993","type":1,"text":"--num_episode 4 : the number of episodes each member of the population will be scored against (i.e. the score will be the average reward across this number of episodes)","markups":[{"type":10,"start":0,"end":15}]},{"name":"84c1","type":1,"text":"--max_length 1000 : the maximum number of time-steps in an episode","markups":[{"type":10,"start":0,"end":17}]},{"name":"d5d9","type":1,"text":"--eval_steps 25: the number of generations between the evaluation of the best set of weights, across 100 episodes","markups":[{"type":10,"start":0,"end":15}]},{"name":"53fb","type":1,"text":"--init_opt ./controller/car_racing.cma.4.32.es.pk By default, the controller will start from scratch each time it is run and save the current state of the process to a pickle file in the controller directory. This argument allows you to continue training from the last save point, by pointing it at the relevant file.","markups":[{"type":10,"start":0,"end":49},{"type":10,"start":187,"end":197}]},{"name":"e5a2","type":1,"text":"After each generation, the current state of the algorithm and the best set of weights will be output to the ./controller folder.","markups":[{"type":10,"start":108,"end":120}]},{"name":"7dcc","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*T3ze0CbMI9EgQSYi1xExhw.png","originalWidth":80,"originalHeight":80}},{"name":"ec27","type":3,"text":"Step 9: Visualise agent","markups":[]},{"name":"76db","type":1,"text":"At the point of writing, I’ve managed to train an agent to achieve an average score of ~833.13 after 200 generations of training. This was trained on Google Cloud using an Ubuntu 16.04, 18 vCPU, 67.5GB RAM machine with the steps and parameters given in this tutorial.","markups":[{"type":1,"start":87,"end":94}]},{"name":"4cdc","type":1,"text":"The authors of the paper managed to achieve an average score of ~906, after 2000 generations of training, which is believed to be the highest score in this environment to date. This utilised a slightly higher spec set-up (e.g. 10,000 episodes of training data, 64 population size, 64 core machine, 16 episodes per trial etc.)","markups":[{"type":1,"start":64,"end":68}]},{"name":"e01e","type":1,"text":"To visualise the current state of your Controller, simply run:","markups":[]},{"name":"2e0b","type":8,"text":"python model.py car_racing --filename ./controller/car_racing.cma.4.32.best.json --render_mode --record_video","markups":[]},{"name":"4f3f","type":1,"text":"--filename : the path to the json of weights that you want to attach to the controller","markups":[{"type":10,"start":0,"end":10}]},{"name":"b32b","type":1,"text":"--render_mode : render the environment on your screen","markups":[{"type":10,"start":0,"end":13}]},{"name":"5033","type":1,"text":"--record_video : outputs mp4 files into the ./video folder, showing each episode","markups":[{"type":10,"start":0,"end":14},{"type":10,"start":44,"end":51}]},{"name":"934c","type":1,"text":"--final_mode : run a 100 episode test of your controller and output the average score.","markups":[{"type":10,"start":0,"end":12}]},{"name":"bd3d","type":1,"text":"Here’s a demo!","markups":[]},{"name":"cdbf","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*-N0F3x2Z3RDvdjEx2rldVg.gif","originalWidth":600,"originalHeight":400}},{"name":"a823","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*8FybAfsBx6GLBLiY2RDY6g.png","originalWidth":80,"originalHeight":80}},{"name":"c9f1","type":3,"text":"Step 10: Hallucinogenic Learning","markups":[]},{"name":"b291","type":1,"text":"That’s already pretty cool — but the next part of the paper is mind-blowingly impressive and I think has major implications for AI.","markups":[]},{"name":"ddbf","type":1,"text":"The paper goes on to show an amazing result, through another environment, DoomTakeCover. The object here is to move an agent to avoid fireballs and stay alive as long as possible.","markups":[{"type":3,"start":74,"end":87,"href":"https://github.com/ppaquette/gym-doom","title":"","rel":"noopener","anchorType":0}]},{"name":"0338","type":1,"text":"The authors show how it is possible for the agent to actually learn how to play the game within its own VAE / RNN inspired hallucinogenic dreams, rather than inside the environment itself.","markups":[{"type":1,"start":62,"end":144}]},{"name":"f27d","type":1,"text":"The only required addition is that the RNN is trained to also predict the probability of being killed in the next time-step. This way, the VAE / RNN combination can be wrapped up as an environment in its own right and used to train the Controller. This is the very concept of a ‘World Model’.","markups":[{"type":1,"start":279,"end":290}]},{"name":"14bc","type":1,"text":"We could summarise the hallucinogenic learning as follows:","markups":[]},{"name":"c004","type":6,"text":"The agent’s initial training data is nothing more than random interactions with the real environment. Through this, it builds up a latent understanding of how the world ‘works’ — its natural groupings, physics and how its own actions affect the state of the world.","markups":[]},{"name":"88ba","type":6,"text":"It can then use this understanding to establish an optimal strategy for a given task, without ever having to actually test it in the real world, because it can use its own mental model of the environment as the ‘playground’ for trying things out.","markups":[]},{"name":"a56c","type":1,"text":"This could easily be a description of a baby learning to walk. There are striking similarities that perhaps run deeper than mere analogy, making this a truly fascinating area of research.","markups":[]},{"name":"9a8c","type":3,"text":"Summary","markups":[]},{"name":"d441","type":1,"text":"Hopefully you find this article useful — let me know in the comments below if you find any typos or have questions about anything in the codebase or article and I’ll get back to you as soon as possible.","markups":[]},{"name":"2e7f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*eDhCRrmRljKt6DegLuwgUg.png","originalWidth":1194,"originalHeight":332}},{"name":"6819","type":1,"text":"If you would like to learn more about how our company, Applied Data Science develops innovative data science solutions for businesses, feel free to get in touch through our website or directly through LinkedIn.","markups":[{"type":3,"start":55,"end":75,"href":"https://applied-data.science","title":"","rel":"","anchorType":0},{"type":3,"start":173,"end":180,"href":"https://applied-data.science","title":"","rel":"","anchorType":0},{"type":3,"start":201,"end":209,"href":"https://www.linkedin.com/in/davidtfoster/","title":"","rel":"","anchorType":0}]},{"name":"6137","type":1,"text":"… and if you like this, feel free to leave a few hearty claps :)","markups":[{"type":2,"start":0,"end":64}]},{"name":"5ff9","type":1,"text":"Applied Data Science is a London based consultancy that implements end-to-end data science solutions for businesses, delivering measurable value. If you’re looking to do more with your data, let’s talk.","markups":[{"type":2,"start":0,"end":202}]},{"name":"6714","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*39gZCiEY2D2vJRzmrYQVNA.png","originalWidth":643,"originalHeight":192}}],"sections":[{"name":"022c","startIndex":0},{"name":"02fc","startIndex":13},{"name":"5cae","startIndex":16},{"name":"c010","startIndex":46},{"name":"0328","startIndex":53},{"name":"a7e1","startIndex":148},{"name":"d461","startIndex":157}]},"postDisplay":{"coverless":true},"metaDescription":"A step-by-step guide to reproducing the World Models paper https://arxiv.org/pdf/1803.10122.pdf"},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"1*ynKeQFaQJn4NxmViJW4KAg.gif","filter":"","backgroundSize":"","originalWidth":386,"originalHeight":186,"strategy":"resample","height":0,"width":0},"wordCount":2861,"imageCount":19,"readingTime":12.49622641509434,"subtitle":"Teaching a machine to master car racing and fireball avoidance through “World Models”","publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":500,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":40805,"virtuals":{"isFollowing":false},"metadata":{"followerCount":23708,"postCount":40805,"coverImage":{"id":"1*CtR2lIHDkhB9M8Jt4irSyg.gif","originalWidth":1000,"originalHeight":287,"isFeatured":true}},"type":"Tag"},{"slug":"artificial-intelligence","name":"Artificial Intelligence","postCount":55612,"virtuals":{"isFollowing":false},"metadata":{"followerCount":672520,"postCount":55612,"coverImage":{"id":"1*gAn_BSffVBcwCIR6bDgK1g.jpeg"}},"type":"Tag"},{"slug":"deep-learning","name":"Deep Learning","postCount":9732,"virtuals":{"isFollowing":false},"metadata":{"followerCount":9981,"postCount":9732,"coverImage":{"id":"1*BdhP4VebJ6_o_QIzjnzofQ.png","originalWidth":702,"originalHeight":575}},"type":"Tag"},{"slug":"data-science","name":"Data Science","postCount":26581,"virtuals":{"isFollowing":false},"metadata":{"followerCount":14288,"postCount":26581,"coverImage":{"id":"1*brSd0r4qZMek1km2JQ-czA.png","originalWidth":3334,"originalHeight":600,"isFeatured":true}},"type":"Tag"},{"slug":"google","name":"Google","postCount":32293,"virtuals":{"isFollowing":false},"metadata":{"followerCount":8661,"postCount":32293,"coverImage":{"id":"1*OW9tjD9rl-Eo51Bd8jz5Qg.png","originalWidth":986,"originalHeight":1308}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":10,"links":{"entries":[{"url":"https://worldmodels.github.io/","alts":[],"httpStatus":200},{"url":"https://keras.io/","alts":[],"httpStatus":200},{"url":"https://gym.openai.com/","alts":[],"httpStatus":200},{"url":"https://www.linkedin.com/in/davidtfoster/","alts":[],"httpStatus":999},{"url":"https://github.com/ppaquette/gym-doom","alts":[],"httpStatus":200},{"url":"https://github.com/hardmaru/estool","alts":[],"httpStatus":200},{"url":"https://github.com/AppliedDataSciencePartners/WorldModels","alts":[],"httpStatus":200},{"url":"https://applied-data.science/the-network/","alts":[],"httpStatus":200},{"url":"https://applied-data.science","alts":[],"httpStatus":200},{"url":"https://cloud.google.com/compute/","alts":[],"httpStatus":200},{"url":"https://medium.com/applied-data-science/how-to-build-your-own-alphazero-ai-using-python-and-keras-7f664945c188","alts":[{"type":2,"url":"medium://p/7f664945c188"},{"type":3,"url":"medium://p/7f664945c188"}],"httpStatus":200},{"url":"https://arxiv.org/abs/1803.10122","alts":[],"httpStatus":200},{"url":"http://blog.otoro.net/2015/12/28/recurrent-net-dreams-up-fake-chinese-characters-in-vector-format-with-tensorflow/","alts":[],"httpStatus":200},{"url":"https://www.tensorflow.org/","alts":[],"httpStatus":200},{"url":"https://arxiv.org/pdf/1803.10122.pdf","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1530435181581},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"A step-by-step guide to reproducing the World Models paper https://arxiv.org/pdf/1803.10122.pdf","totalClapCount":3001,"sectionCount":7,"readingList":0,"topics":[]},"coverless":true,"slug":"how-to-build-your-own-world-model-using-python-and-keras","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459","previewContent":{"bodyModel":{"paragraphs":[{"name":"9477","type":3,"text":"Hallucinogenic Deep Reinforcement Learning Using Python and Keras","markups":[],"alignment":1},{"name":"6c4a","type":13,"text":"Teaching a machine to master car racing and fireball avoidance through “World Models”","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459","approvedHomeCollectionId":"70cd67c5d0e","approvedHomeCollection":{"id":"70cd67c5d0e","name":"Applied Data Science","slug":"applied-data-science","tags":["ARTIFICIAL INTELLIGENCE","DATA SCIENCE","DEEP LEARNING","MACHINE LEARNING","PYTHON"],"creatorId":"2d3c4b088dc6","description":"Cutting edge data science news and projects","shortDescription":"Cutting edge data science news and projects","image":{"imageId":"1*KAi60U6aOWD27X9CFI369A.png","filter":"","backgroundSize":"","originalWidth":512,"originalHeight":512,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":3024,"activeAt":1523980580383},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*2A6OcWvQBoboXH2AW0LQMw.png","filter":"","backgroundSize":"","originalWidth":1378,"originalHeight":410,"strategy":"resample","height":0,"width":0},"twitterUsername":"applied_data","publicEmail":"info@applied-data.science","sections":[{"type":2,"collectionHeaderMetadata":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"e1155640b5e1"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":11,"postIds":[]}}],"tintColor":"#FF292B3C","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF818398","point":0},{"color":"#FF787A8C","point":0.1},{"color":"#FF6F7181","point":0.2},{"color":"#FF666776","point":0.3},{"color":"#FF5D5E6A","point":0.4},{"color":"#FF53535E","point":0.5},{"color":"#FF484952","point":0.6},{"color":"#FF3E3E46","point":0.7},{"color":"#FF323339","point":0.8},{"color":"#FF27272B","point":0.9},{"color":"#FF1A1A1D","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF292B3C","point":0},{"color":"#FF444656","point":0.1},{"color":"#FF5D5E6E","point":0.2},{"color":"#FF747584","point":0.3},{"color":"#FF8A8B98","point":0.4},{"color":"#FF9F9FAB","point":0.5},{"color":"#FFB3B3BE","point":0.6},{"color":"#FFC7C7D0","point":0.7},{"color":"#FFDBDAE1","point":0.8},{"color":"#FFEEECF2","point":0.9},{"color":"#FFFFFEFF","point":1}],"backgroundColor":"#FF292B3C"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF3F2F7","point":0},{"color":"#FFF1F0F6","point":0.1},{"color":"#FFEFEEF6","point":0.2},{"color":"#FFEDECF5","point":0.3},{"color":"#FFEBEAF4","point":0.4},{"color":"#FFE9E8F3","point":0.5},{"color":"#FFE7E6F3","point":0.6},{"color":"#FFE4E4F2","point":0.7},{"color":"#FFE2E2F1","point":0.8},{"color":"#FFE0E0F1","point":0.9},{"color":"#FFDEDEF0","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":1,"title":"Blog","tagSlug":"data-science","url":"https://medium.com/applied-data-science/tagged/data-science","source":"tagSlug"},{"type":3,"title":"MAIN SITE","url":"http://applied-data.science"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459","mediumUrl":"https://medium.com/applied-data-science/how-to-build-your-own-world-model-using-python-and-keras-64fb388ba459","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"featureLockRequestMinimumGuaranteeAmount":0,"isElevate":false,"mongerRequestType":1,"layerCake":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"2d3c4b088dc6":{"userId":"2d3c4b088dc6","name":"David Foster","username":"dtfoster","createdAt":1487612215156,"lastPostCreatedAt":1527088695667,"imageId":"1*QqMD1rth7ahcS7Gc415R9w.jpeg","backgroundImageId":"","bio":"Co-founder of Applied Data Science","socialStats":{"userId":"2d3c4b088dc6","usersFollowedCount":67,"usersFollowedByCount":2937,"type":"SocialStats"},"social":{"userId":"lo_6eca48311aab","targetUserId":"2d3c4b088dc6","type":"Social"},"allowNotes":1,"isNsfw":false,"isWriterProgramInvited":false,"isPartnerProgramEnrolled":false,"isWriterProgramEnrolled":false,"type":"User"}},"Collection":{"70cd67c5d0e":{"id":"70cd67c5d0e","name":"Applied Data Science","slug":"applied-data-science","tags":["ARTIFICIAL INTELLIGENCE","DATA SCIENCE","DEEP LEARNING","MACHINE LEARNING","PYTHON"],"creatorId":"2d3c4b088dc6","description":"Cutting edge data science news and projects","shortDescription":"Cutting edge data science news and projects","image":{"imageId":"1*KAi60U6aOWD27X9CFI369A.png","filter":"","backgroundSize":"","originalWidth":512,"originalHeight":512,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":3024,"activeAt":1523980580383},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*2A6OcWvQBoboXH2AW0LQMw.png","filter":"","backgroundSize":"","originalWidth":1378,"originalHeight":410,"strategy":"resample","height":0,"width":0},"twitterUsername":"applied_data","publicEmail":"info@applied-data.science","sections":[{"type":2,"collectionHeaderMetadata":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"e1155640b5e1"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":11,"postIds":[]}}],"tintColor":"#FF292B3C","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF818398","point":0},{"color":"#FF787A8C","point":0.1},{"color":"#FF6F7181","point":0.2},{"color":"#FF666776","point":0.3},{"color":"#FF5D5E6A","point":0.4},{"color":"#FF53535E","point":0.5},{"color":"#FF484952","point":0.6},{"color":"#FF3E3E46","point":0.7},{"color":"#FF323339","point":0.8},{"color":"#FF27272B","point":0.9},{"color":"#FF1A1A1D","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF292B3C","point":0},{"color":"#FF444656","point":0.1},{"color":"#FF5D5E6E","point":0.2},{"color":"#FF747584","point":0.3},{"color":"#FF8A8B98","point":0.4},{"color":"#FF9F9FAB","point":0.5},{"color":"#FFB3B3BE","point":0.6},{"color":"#FFC7C7D0","point":0.7},{"color":"#FFDBDAE1","point":0.8},{"color":"#FFEEECF2","point":0.9},{"color":"#FFFFFEFF","point":1}],"backgroundColor":"#FF292B3C"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF3F2F7","point":0},{"color":"#FFF1F0F6","point":0.1},{"color":"#FFEFEEF6","point":0.2},{"color":"#FFEDECF5","point":0.3},{"color":"#FFEBEAF4","point":0.4},{"color":"#FFE9E8F3","point":0.5},{"color":"#FFE7E6F3","point":0.6},{"color":"#FFE4E4F2","point":0.7},{"color":"#FFE2E2F1","point":0.8},{"color":"#FFE0E0F1","point":0.9},{"color":"#FFDEDEF0","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":1,"title":"Blog","tagSlug":"data-science","url":"https://medium.com/applied-data-science/tagged/data-science","source":"tagSlug"},{"type":3,"title":"MAIN SITE","url":"http://applied-data.science"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"backgroundImage":{"id":"1*_rEv_Mi0-gmBE6tt2PB1MA.png","originalWidth":2030,"originalHeight":980},"logoImage":{"id":"1*j2WfDBikc1gRfK9GYXP3AA@2x.png","originalWidth":1106,"originalHeight":247,"alt":"Applied Data Science"},"alignment":2,"layout":5},"type":"Collection"}},"Social":{"2d3c4b088dc6":{"userId":"lo_6eca48311aab","targetUserId":"2d3c4b088dc6","type":"Social"}},"SocialStats":{"2d3c4b088dc6":{"userId":"2d3c4b088dc6","usersFollowedCount":67,"usersFollowedByCount":2937,"type":"SocialStats"}}}})
// ]]></script><!-- START Parse.ly Include: Standard --><div id="parsely-root" style="display: none"><span id="parsely-cfg" data-parsely-site="medium.com"></span><script id="parsely-script" async="" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/p.js"></script></div><script>(function(s, p, d) {var h = d.location.protocol, i = p + "-" + s, e = d.getElementById(i), r = d.getElementById(p + "-root"), u = h === "https:" ? "d1z2jf7jlzjs58.cloudfront.net" : "static." + p + ".com"; if (e) return; e = d.createElement(s); e.id = i; e.async = true; e.src = h + "//" + u + "/p.js"; r.appendChild(e);})("script", "parsely", document);</script><!-- END Parse.ly Include: Standard --><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/main-common-async.bundle.WKmfPf9Nj8xCneCN6TKlEA.js"></script><script charset="UTF-8" src="./Hallucinogenic Deep Reinforcement Learning using Python and Keras_files/main-notes.bundle.LUI7G9sM3rPgZyAJHfZQig.js"></script></body></html>